import PyObject from 'components/PyObject';
import { ExampleReferenceLink } from 'components/ExampleReference';

# Hooks

<ExampleReferenceLink filePath="examples/hooks" />

This pipeline demonstrates how to create success and failure handling policies on pipelines using <PyObject module="dagster" object="success_hook" displayText='@success_hook'/> and <PyObject module="dagster" object="failure_hook" displayText='@failure_hook' />.

## Create a hook

A <PyObject module="dagster" object="success_hook" displayText="@success_hook" /> or <PyObject module="dagster" object="failure_hook" displayText="@failure_hook" /> decorated function is called a hook. Through the argument, we provide `context` which is an instance of <PyObject module="dagster" object="HookContext" /> and gives you the access to some system information, such as

- `context.log`: loggers
- `context.solid`: the solid associated with the hook.
- `context.step`: the execution step that triggers the hook.
- `context.resources`: the resources the hook can use.

Hooks use resource keys to access resources. After including the resource key in its set of required_resource_keys, the body of the hook can access the corresponding resource via the “resources” attribute of its context object.

```python literalinclude caption=repo.py showLines startLine=6 emphasize-lines=1,7
file:/hooks/repo.py
lines:6-15
```

It also enables you to switch resource values in different modes so that, for example, you can send slack messages only when you are in "prod" mode and mock the slack resource when you are in "dev" mode.

```python literalinclude caption=repo.py showLines startLine=29 emphasize-lines=3
file:/hooks/repo.py
lines:29-34
```

```yaml literalinclude caption=dev.yaml emphasize-lines=4
file:/hooks/dev.yaml
```

## Apply a hook on a pipeline

There are a few ways to apply hooks. For example, you want to send a slack message to a channel when any solid fails in a pipeline. In this case, we will be applying a hook on a pipeline, which will apply the hook on every solid instance within in that pipeline.

You can simply use the hook created "slack_on_failure" above to decorate the pipeline "notif_all". Then, slack messages will be sent when any solid in the pipeline fails.

```python literalinclude caption=repo.py showLines startLine=28 emphasize-lines=1
file:/hooks/repo.py
lines:28-38
```

## Apply a hook on a solid

However, sometimes a pipeline is a shared responsibility or you only want to be alerted on high-priority solid executions. So we also provide a way to set up hooks on solid instances which enables you to apply policies on a per-solid basis.

```python literalinclude caption=repo.py showLines startLine=41 emphasize-lines=9
file:/hooks/repo.py
lines:41-51
```

In this case, solid "b" won't trigger any hooks, while when solid "a" fails or succeeds it will send a slack message.

## Open in a playground

[![Open in Gitpod](https://gitpod.io/button/open-in-gitpod.svg)](https://gitpod.io/#EXAMPLE=hooks/https://github.com/dagster-io/dagster)

## Download

```
curl https://codeload.github.com/dagster-io/dagster/tar.gz/master | tar -xz --strip=2 dagster-master/examples/hooks
cd hooks
```
