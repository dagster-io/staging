{"parents": [{"link": "../../../../", "title": "Module code"}], "title": "dagster.core.definitions.input", "body": "<h1>Source code for dagster.core.definitions.input</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">from</span> <span class=\"nn\">collections</span> <span class=\"kn\">import</span> <span class=\"n\">namedtuple</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dagster</span> <span class=\"kn\">import</span> <span class=\"n\">check</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.errors</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterInvalidDefinitionError</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.types.dagster_type</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">BuiltinScalarDagsterType</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterType</span><span class=\"p\">,</span>\n    <span class=\"n\">resolve_dagster_type</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">.utils</span> <span class=\"kn\">import</span> <span class=\"n\">check_valid_name</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">_NoValueSentinel</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"k\">pass</span>\n\n\n<span class=\"c1\"># unfortunately since type_check functions need TypeCheckContext which is only available</span>\n<span class=\"c1\"># at runtime, we can only check basic types before runtime</span>\n<span class=\"k\">def</span> <span class=\"nf\">_check_default_value</span><span class=\"p\">(</span><span class=\"n\">input_name</span><span class=\"p\">,</span> <span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">default_value</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"n\">default_value</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"n\">_NoValueSentinel</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">is_nothing</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;Setting a default_value is invalid on InputDefinitions of type Nothing&quot;</span>\n            <span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">BuiltinScalarDagsterType</span><span class=\"p\">):</span>\n            <span class=\"n\">type_check</span> <span class=\"o\">=</span> <span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">type_check_scalar_value</span><span class=\"p\">(</span><span class=\"n\">default_value</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">type_check</span><span class=\"o\">.</span><span class=\"n\">success</span><span class=\"p\">:</span>\n                <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n                    <span class=\"p\">(</span>\n                        <span class=\"s2\">&quot;Type check failed for the default_value of InputDefinition &quot;</span>\n                        <span class=\"s2\">&quot;</span><span class=\"si\">{input_name}</span><span class=\"s2\"> of type </span><span class=\"si\">{dagster_type}</span><span class=\"s2\">. &quot;</span>\n                        <span class=\"s2\">&quot;Received value </span><span class=\"si\">{value}</span><span class=\"s2\"> of type </span><span class=\"si\">{type}</span><span class=\"s2\">&quot;</span>\n                    <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                        <span class=\"n\">input_name</span><span class=\"o\">=</span><span class=\"n\">input_name</span><span class=\"p\">,</span>\n                        <span class=\"n\">dagster_type</span><span class=\"o\">=</span><span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">display_name</span><span class=\"p\">,</span>\n                        <span class=\"n\">value</span><span class=\"o\">=</span><span class=\"n\">default_value</span><span class=\"p\">,</span>\n                        <span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">default_value</span><span class=\"p\">),</span>\n                    <span class=\"p\">),</span>\n                <span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">default_value</span>\n\n\n<div class=\"viewcode-block\" id=\"InputDefinition\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/solids/#dagster.InputDefinition\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">InputDefinition</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Defines an argument to a solid&#39;s compute function.</span>\n\n<span class=\"sd\">    Inputs may flow from previous solids&#39; outputs, or be stubbed using config. They may optionally</span>\n<span class=\"sd\">    be typed using the Dagster type system.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        name (str): Name of the input.</span>\n<span class=\"sd\">        dagster_type (Optional[Any]):  The type of this input. Users should provide one of the</span>\n<span class=\"sd\">            :ref:`built-in types &lt;builtin&gt;`, a dagster type explicitly constructed with</span>\n<span class=\"sd\">            :py:func:`as_dagster_type`, :py:func:`@usable_as_dagster_type &lt;dagster_type`, or</span>\n<span class=\"sd\">            :py:func:`PythonObjectDagsterType`, or a Python type. Defaults to :py:class:`Any`.</span>\n<span class=\"sd\">        description (Optional[str]): Human-readable description of the input.</span>\n<span class=\"sd\">        default_value (Optional[Any]): The default value to use if no input is provided.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">dagster_type</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">default_value</span><span class=\"o\">=</span><span class=\"n\">_NoValueSentinel</span><span class=\"p\">):</span>\n        <span class=\"s2\">&quot;&quot;</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_name</span> <span class=\"o\">=</span> <span class=\"n\">check_valid_name</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dagster_type</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst</span><span class=\"p\">(</span><span class=\"n\">resolve_dagster_type</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">),</span> <span class=\"n\">DagsterType</span><span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_description</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">description</span><span class=\"p\">,</span> <span class=\"s2\">&quot;description&quot;</span><span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span> <span class=\"o\">=</span> <span class=\"n\">_check_default_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_name</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dagster_type</span><span class=\"p\">,</span> <span class=\"n\">default_value</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">name</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_name</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">dagster_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dagster_type</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">description</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_description</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">has_default_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"n\">_NoValueSentinel</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">default_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">invariant</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">has_default_value</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Can only fetch default_value if has_default_value&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span>\n\n<div class=\"viewcode-block\" id=\"InputDefinition.mapping_to\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/solids/#dagster.InputDefinition.mapping_to\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">mapping_to</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">solid_name</span><span class=\"p\">,</span> <span class=\"n\">input_name</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;Create an input mapping to an input of a child solid.</span>\n\n<span class=\"sd\">        In a CompositeSolidDefinition, you can use this helper function to construct</span>\n<span class=\"sd\">        an :py:class:`InputMapping` to the input of a child solid.</span>\n\n<span class=\"sd\">        Args:</span>\n<span class=\"sd\">            solid_name (str): The name of the child solid to which to map this input.</span>\n<span class=\"sd\">            input_name (str): The name of the child solid&#39; input to which to map this input.</span>\n\n<span class=\"sd\">        Examples:</span>\n\n<span class=\"sd\">            .. code-block:: python</span>\n\n<span class=\"sd\">                input_mapping = InputDefinition(&#39;composite_input&#39;, Int).mapping_to(</span>\n<span class=\"sd\">                    &#39;child_solid&#39;, &#39;int_input&#39;</span>\n<span class=\"sd\">                )</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">return</span> <span class=\"n\">InputMapping</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">solid_name</span><span class=\"p\">,</span> <span class=\"n\">input_name</span><span class=\"p\">)</span></div></div>\n\n\n<div class=\"viewcode-block\" id=\"InputMapping\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/solids/#dagster.InputMapping\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">InputMapping</span><span class=\"p\">(</span><span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_InputMapping&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;definition solid_name input_name&quot;</span><span class=\"p\">)):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Defines an input mapping for a composite solid.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        definition (InputDefinition): Defines the input to the composite solid.</span>\n<span class=\"sd\">        solid_name (str): The name of the child solid onto which to map the input.</span>\n<span class=\"sd\">        input_name (str): The name of the input to the child solid onto which to map the input.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">definition</span><span class=\"p\">,</span> <span class=\"n\">solid_name</span><span class=\"p\">,</span> <span class=\"n\">input_name</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">InputMapping</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">definition</span><span class=\"p\">,</span> <span class=\"s2\">&quot;definition&quot;</span><span class=\"p\">,</span> <span class=\"n\">InputDefinition</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">solid_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;solid_name&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">input_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;input_name&quot;</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span></div>\n</pre></div>", "current_page_name": "_modules/dagster/core/definitions/input", "sidebars": ["globaltoc.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}