{"parents": [{"link": "../../../../", "title": "Module code"}], "title": "dagster.core.types.config_schema", "body": "<h1>Source code for dagster.core.types.config_schema</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">import</span> <span class=\"nn\">hashlib</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dagster</span> <span class=\"kn\">import</span> <span class=\"n\">check</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.config.config_type</span> <span class=\"kn\">import</span> <span class=\"n\">ConfigType</span><span class=\"p\">,</span> <span class=\"n\">ConfigTypeKind</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.decorator_utils</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">split_function_parameters</span><span class=\"p\">,</span>\n    <span class=\"n\">validate_decorated_fn_positionals</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.errors</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterInvalidDefinitionError</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils</span> <span class=\"kn\">import</span> <span class=\"n\">ensure_gen</span><span class=\"p\">,</span> <span class=\"n\">ensure_single_item</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils.backcompat</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">canonicalize_backcompat_args</span><span class=\"p\">,</span>\n    <span class=\"n\">experimental_arg_warning</span><span class=\"p\">,</span>\n    <span class=\"n\">rename_warning</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DagsterTypeLoader</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">schema_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">not_implemented</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;Must override schema_type in </span><span class=\"si\">{klass}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">klass</span><span class=\"o\">=</span><span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">loader_version</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"kc\">None</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">compute_loaded_input_version</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">_config_value</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"kc\">None</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">construct_from_config_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">_context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        How to create a runtime value from config data.</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">return</span> <span class=\"n\">config_value</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">required_resource_keys</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">frozenset</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">InputHydrationConfig</span><span class=\"p\">(</span><span class=\"n\">DagsterTypeLoader</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">rename_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;DagsterTypeLoader&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;InputHydrationConfig&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">)</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">InputHydrationConfig</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DagsterTypeMaterializer</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">schema_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">not_implemented</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;Must override schema_type in </span><span class=\"si\">{klass}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">klass</span><span class=\"o\">=</span><span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">materialize_runtime_values</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">_context</span><span class=\"p\">,</span> <span class=\"n\">_config_value</span><span class=\"p\">,</span> <span class=\"n\">_runtime_value</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">        How to materialize a runtime value given configuration.</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">not_implemented</span><span class=\"p\">(</span><span class=\"s2\">&quot;Must implement&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">required_resource_keys</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">frozenset</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">OutputMaterializationConfig</span><span class=\"p\">(</span><span class=\"n\">DagsterTypeMaterializer</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">rename_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;DagsterTypeMaterializer&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;OutputMaterializationConfig&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">)</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">OutputMaterializationConfig</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DagsterTypeLoaderFromDecorator</span><span class=\"p\">(</span><span class=\"n\">DagsterTypeLoader</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span>\n        <span class=\"n\">config_type</span><span class=\"p\">,</span>\n        <span class=\"n\">func</span><span class=\"p\">,</span>\n        <span class=\"n\">required_resource_keys</span><span class=\"p\">,</span>\n        <span class=\"n\">loader_version</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">external_version_fn</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_config_type</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_type&quot;</span><span class=\"p\">,</span> <span class=\"n\">ConfigType</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_func</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">callable_param</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"s2\">&quot;func&quot;</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_set_param</span><span class=\"p\">(</span>\n            <span class=\"n\">required_resource_keys</span><span class=\"p\">,</span> <span class=\"s2\">&quot;required_resource_keys&quot;</span><span class=\"p\">,</span> <span class=\"n\">of_type</span><span class=\"o\">=</span><span class=\"nb\">str</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_loader_version</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">loader_version</span><span class=\"p\">,</span> <span class=\"s2\">&quot;loader_version&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_loader_version</span><span class=\"p\">:</span>\n            <span class=\"n\">experimental_arg_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;loader_version&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;DagsterTypeLoaderFromDecorator.__init__&quot;</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_external_version_fn</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_callable_param</span><span class=\"p\">(</span>\n            <span class=\"n\">external_version_fn</span><span class=\"p\">,</span> <span class=\"s2\">&quot;external_version_fn&quot;</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_external_version_fn</span><span class=\"p\">:</span>\n            <span class=\"n\">experimental_arg_warning</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;external_version_fn&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;DagsterTypeLoaderFromDecorator.__init__&quot;</span>\n            <span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">schema_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_config_type</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">loader_version</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_loader_version</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">compute_loaded_input_version</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;Compute the type-loaded input from a given config_value.</span>\n\n<span class=\"sd\">        Args:</span>\n<span class=\"sd\">            config_value (Union[Any, Dict]): Config value to be ingested by the external version</span>\n<span class=\"sd\">                loading function.</span>\n<span class=\"sd\">        Returns:</span>\n<span class=\"sd\">            Optional[str]: Hash of concatenated loader version and external input version if both</span>\n<span class=\"sd\">                are provided, else None.</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"n\">version</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">loader_version</span><span class=\"p\">:</span>\n            <span class=\"n\">version</span> <span class=\"o\">+=</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">loader_version</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_external_version_fn</span><span class=\"p\">:</span>\n            <span class=\"n\">ext_version</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_external_version_fn</span><span class=\"p\">(</span><span class=\"n\">config_value</span><span class=\"p\">)</span>\n            <span class=\"n\">version</span> <span class=\"o\">+=</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">ext_version</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">version</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;&quot;</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"kc\">None</span>  <span class=\"c1\"># Sentinel value for no version provided.</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"n\">hashlib</span><span class=\"o\">.</span><span class=\"n\">sha1</span><span class=\"p\">(</span><span class=\"n\">version</span><span class=\"o\">.</span><span class=\"n\">encode</span><span class=\"p\">(</span><span class=\"s2\">&quot;utf-8&quot;</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">hexdigest</span><span class=\"p\">()</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">construct_from_config_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_func</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">required_resource_keys</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">frozenset</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_create_type_loader_for_decorator</span><span class=\"p\">(</span>\n    <span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">,</span> <span class=\"n\">loader_version</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">external_version_fn</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n<span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">DagsterTypeLoaderFromDecorator</span><span class=\"p\">(</span>\n        <span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">,</span> <span class=\"n\">loader_version</span><span class=\"p\">,</span> <span class=\"n\">external_version_fn</span>\n    <span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"input_hydration_config\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/types/#dagster.input_hydration_config\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">input_hydration_config</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">config_cls</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Deprecated in favor of dagster_type_loader&quot;&quot;&quot;</span>\n    <span class=\"n\">rename_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;dagster_type_loader&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;input_hydration_config&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">config_schema</span> <span class=\"o\">=</span> <span class=\"n\">canonicalize_backcompat_args</span><span class=\"p\">(</span>\n        <span class=\"n\">config_schema</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_schema&quot;</span><span class=\"p\">,</span> <span class=\"n\">config_cls</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_cls&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">dagster_type_loader</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"dagster_type_loader\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/types/#dagster.dagster_type_loader\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">dagster_type_loader</span><span class=\"p\">(</span>\n    <span class=\"n\">config_schema</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">loader_version</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">external_version_fn</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n<span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Create an dagster type loader that maps config data to a runtime value.</span>\n\n<span class=\"sd\">    The decorated function should take the execution context and parsed config value and return the</span>\n<span class=\"sd\">    appropriate runtime value.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        config_schema (ConfigSchema): The schema for the config that&#39;s passed to the decorated</span>\n<span class=\"sd\">            function.</span>\n<span class=\"sd\">        loader_version (str): (Experimental) The version of the decorated compute function. Two</span>\n<span class=\"sd\">            loading functions should have the same version if and only if they deterministically</span>\n<span class=\"sd\">            produce the same outputs when provided the same inputs.</span>\n<span class=\"sd\">        external_version_fn (Callable): (Experimental) A function that takes in the same parameters as the loader</span>\n<span class=\"sd\">            function (config_value) and returns a representation of the version of the external</span>\n<span class=\"sd\">            asset (str). Two external assets with identical versions are treated as identical to one</span>\n<span class=\"sd\">            another.</span>\n\n<span class=\"sd\">    Examples:</span>\n\n<span class=\"sd\">    .. code-block:: python</span>\n\n<span class=\"sd\">        @dagster_type_loader(Permissive())</span>\n<span class=\"sd\">        def load_dict(_context, value):</span>\n<span class=\"sd\">            return value</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.config.field</span> <span class=\"kn\">import</span> <span class=\"n\">resolve_to_config_type</span>\n\n    <span class=\"n\">config_type</span> <span class=\"o\">=</span> <span class=\"n\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"p\">)</span>\n    <span class=\"n\">EXPECTED_POSITIONALS</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;context&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;*&quot;</span><span class=\"p\">]</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">wrapper</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"p\">):</span>\n        <span class=\"n\">fn_positionals</span><span class=\"p\">,</span> <span class=\"n\">_</span> <span class=\"o\">=</span> <span class=\"n\">split_function_parameters</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">EXPECTED_POSITIONALS</span><span class=\"p\">)</span>\n        <span class=\"n\">missing_positional</span> <span class=\"o\">=</span> <span class=\"n\">validate_decorated_fn_positionals</span><span class=\"p\">(</span><span class=\"n\">fn_positionals</span><span class=\"p\">,</span> <span class=\"n\">EXPECTED_POSITIONALS</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">missing_positional</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;@dagster_type_loader &#39;</span><span class=\"si\">{solid_name}</span><span class=\"s2\">&#39; decorated function does not have required positional &quot;</span>\n                <span class=\"s2\">&quot;parameter &#39;</span><span class=\"si\">{missing_param}</span><span class=\"s2\">&#39;. Solid functions should only have keyword arguments &quot;</span>\n                <span class=\"s2\">&quot;that match input names and a first positional parameter named &#39;context&#39;.&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                    <span class=\"n\">solid_name</span><span class=\"o\">=</span><span class=\"n\">func</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">,</span> <span class=\"n\">missing_param</span><span class=\"o\">=</span><span class=\"n\">missing_positional</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">_create_type_loader_for_decorator</span><span class=\"p\">(</span>\n            <span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">,</span> <span class=\"n\">loader_version</span><span class=\"p\">,</span> <span class=\"n\">external_version_fn</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">wrapper</span></div>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">input_selector_schema</span><span class=\"p\">(</span><span class=\"n\">config_cls</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Deprecated in favor of dagster_type_loader.</span>\n\n<span class=\"sd\">    A decorator for annotating a function that can take the selected properties</span>\n<span class=\"sd\">    from a ``config_value`` in to an instance of a custom type.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        config_cls (Selector)</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">rename_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;dagster_type_loader&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;input_selector_schema&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">)</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.config.field</span> <span class=\"kn\">import</span> <span class=\"n\">resolve_to_config_type</span>\n\n    <span class=\"n\">config_type</span> <span class=\"o\">=</span> <span class=\"n\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">config_cls</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">param_invariant</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"o\">.</span><span class=\"n\">kind</span> <span class=\"o\">==</span> <span class=\"n\">ConfigTypeKind</span><span class=\"o\">.</span><span class=\"n\">SELECTOR</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_cls&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_wrap</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"p\">):</span>\n        <span class=\"k\">def</span> <span class=\"nf\">_selector</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">):</span>\n            <span class=\"n\">selector_key</span><span class=\"p\">,</span> <span class=\"n\">selector_value</span> <span class=\"o\">=</span> <span class=\"n\">ensure_single_item</span><span class=\"p\">(</span><span class=\"n\">config_value</span><span class=\"p\">)</span>\n            <span class=\"k\">return</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">selector_key</span><span class=\"p\">,</span> <span class=\"n\">selector_value</span><span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">_create_type_loader_for_decorator</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">_selector</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">_wrap</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">DagsterTypeMaterializerForDecorator</span><span class=\"p\">(</span><span class=\"n\">DagsterTypeMaterializer</span><span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_config_type</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_type&quot;</span><span class=\"p\">,</span> <span class=\"n\">ConfigType</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_func</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">callable_param</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"s2\">&quot;func&quot;</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_set_param</span><span class=\"p\">(</span>\n            <span class=\"n\">required_resource_keys</span><span class=\"p\">,</span> <span class=\"s2\">&quot;required_resource_keys&quot;</span><span class=\"p\">,</span> <span class=\"n\">of_type</span><span class=\"o\">=</span><span class=\"nb\">str</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">schema_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_config_type</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">materialize_runtime_values</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">,</span> <span class=\"n\">runtime_value</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">ensure_gen</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_func</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">,</span> <span class=\"n\">runtime_value</span><span class=\"p\">))</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">required_resource_keys</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">frozenset</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_create_output_materializer_for_decorator</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">DagsterTypeMaterializerForDecorator</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"output_materialization_config\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/types/#dagster.output_materialization_config\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">output_materialization_config</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">config_cls</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Deprecated in favor of dagster_type_materializer&quot;&quot;&quot;</span>\n    <span class=\"n\">rename_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;dagster_type_materializer&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;output_materialization_config&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">config_schema</span> <span class=\"o\">=</span> <span class=\"n\">canonicalize_backcompat_args</span><span class=\"p\">(</span>\n        <span class=\"n\">config_schema</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_schema&quot;</span><span class=\"p\">,</span> <span class=\"n\">config_cls</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_cls&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">dagster_type_materializer</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"p\">)</span></div>\n\n\n<div class=\"viewcode-block\" id=\"dagster_type_materializer\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/types/#dagster.dagster_type_materializer\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">dagster_type_materializer</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Create an output materialization hydration config that configurably materializes a runtime</span>\n<span class=\"sd\">    value.</span>\n\n<span class=\"sd\">    The decorated function should take the execution context, the parsed config value, and the</span>\n<span class=\"sd\">    runtime value and the parsed config data, should materialize the runtime value, and should</span>\n<span class=\"sd\">    return an appropriate :py:class:`AssetMaterialization`.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        config_schema (Any): The type of the config data expected by the decorated function.</span>\n\n<span class=\"sd\">    Examples:</span>\n\n<span class=\"sd\">    .. code-block:: python</span>\n\n<span class=\"sd\">        # Takes a list of dicts such as might be read in using csv.DictReader, as well as a config</span>\n<span class=\"sd\">        value, and writes</span>\n<span class=\"sd\">        @dagster_type_materializer(str)</span>\n<span class=\"sd\">        def materialize_df(_context, path, value):</span>\n<span class=\"sd\">            with open(path, &#39;w&#39;) as fd:</span>\n<span class=\"sd\">                writer = csv.DictWriter(fd, fieldnames=value[0].keys())</span>\n<span class=\"sd\">                writer.writeheader()</span>\n<span class=\"sd\">                writer.writerows(rowdicts=value)</span>\n\n<span class=\"sd\">            return AssetMaterialization.file(path)</span>\n\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.config.field</span> <span class=\"kn\">import</span> <span class=\"n\">resolve_to_config_type</span>\n\n    <span class=\"n\">config_type</span> <span class=\"o\">=</span> <span class=\"n\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">config_schema</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"k\">lambda</span> <span class=\"n\">func</span><span class=\"p\">:</span> <span class=\"n\">_create_output_materializer_for_decorator</span><span class=\"p\">(</span>\n        <span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">func</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span>\n    <span class=\"p\">)</span></div>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">output_selector_schema</span><span class=\"p\">(</span><span class=\"n\">config_cls</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    Deprecated in favor of dagster_type_materializer.</span>\n\n<span class=\"sd\">    A decorator for a annotating a function that can take the selected properties</span>\n<span class=\"sd\">    of a ``config_value`` and an instance of a custom type and materialize it.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        config_cls (Selector):</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n    <span class=\"n\">rename_warning</span><span class=\"p\">(</span><span class=\"s2\">&quot;dagster_type_materializer&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;output_selector_schema&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">)</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.config.field</span> <span class=\"kn\">import</span> <span class=\"n\">resolve_to_config_type</span>\n\n    <span class=\"n\">config_type</span> <span class=\"o\">=</span> <span class=\"n\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">config_cls</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">param_invariant</span><span class=\"p\">(</span><span class=\"n\">config_type</span><span class=\"o\">.</span><span class=\"n\">kind</span> <span class=\"o\">==</span> <span class=\"n\">ConfigTypeKind</span><span class=\"o\">.</span><span class=\"n\">SELECTOR</span><span class=\"p\">,</span> <span class=\"s2\">&quot;config_cls&quot;</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_wrap</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"p\">):</span>\n        <span class=\"k\">def</span> <span class=\"nf\">_selector</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">config_value</span><span class=\"p\">,</span> <span class=\"n\">runtime_value</span><span class=\"p\">):</span>\n            <span class=\"n\">selector_key</span><span class=\"p\">,</span> <span class=\"n\">selector_value</span> <span class=\"o\">=</span> <span class=\"n\">ensure_single_item</span><span class=\"p\">(</span><span class=\"n\">config_value</span><span class=\"p\">)</span>\n            <span class=\"k\">return</span> <span class=\"n\">func</span><span class=\"p\">(</span><span class=\"n\">context</span><span class=\"p\">,</span> <span class=\"n\">selector_key</span><span class=\"p\">,</span> <span class=\"n\">selector_value</span><span class=\"p\">,</span> <span class=\"n\">runtime_value</span><span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">_create_output_materializer_for_decorator</span><span class=\"p\">(</span>\n            <span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">_selector</span><span class=\"p\">,</span> <span class=\"n\">required_resource_keys</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">_wrap</span>\n</pre></div>", "current_page_name": "_modules/dagster/core/types/config_schema", "sidebars": ["globaltoc.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}