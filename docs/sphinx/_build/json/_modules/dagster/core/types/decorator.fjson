{"parents": [{"link": "../../../../", "title": "Module code"}], "title": "dagster.core.types.decorator", "body": "<h1>Source code for dagster.core.types.decorator</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">from</span> <span class=\"nn\">dagster</span> <span class=\"kn\">import</span> <span class=\"n\">check</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils.backcompat</span> <span class=\"kn\">import</span> <span class=\"n\">canonicalize_backcompat_args</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">.dagster_type</span> <span class=\"kn\">import</span> <span class=\"n\">PythonObjectDagsterType</span><span class=\"p\">,</span> <span class=\"n\">make_python_type_usable_as_dagster_type</span>\n\n\n<div class=\"viewcode-block\" id=\"usable_as_dagster_type\"><a class=\"viewcode-back\" href=\"../../../../../sections/api/apidocs/types/#dagster.usable_as_dagster_type\">[docs]</a><span class=\"k\">def</span> <span class=\"nf\">usable_as_dagster_type</span><span class=\"p\">(</span>\n    <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"n\">loader</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"n\">materializer</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"n\">serialization_strategy</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"n\">auto_plugins</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"c1\"># Graveyard is below</span>\n    <span class=\"n\">input_hydration_config</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"n\">output_materialization_config</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n<span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Decorate a Python class to make it usable as a Dagster Type.</span>\n\n<span class=\"sd\">    This is intended to make it straightforward to annotate existing business logic classes to</span>\n<span class=\"sd\">    make them dagster types whose typecheck is an isinstance check against that python class.</span>\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        python_type (cls): The python type to make usable as python type.</span>\n<span class=\"sd\">        name (Optional[str]): Name of the new Dagster type. If ``None``, the name (``__name__``) of</span>\n<span class=\"sd\">            the ``python_type`` will be used.</span>\n<span class=\"sd\">        description (Optional[str]): A user-readable description of the type.</span>\n<span class=\"sd\">        loader (Optional[DagsterTypeLoader]): An instance of a class that</span>\n<span class=\"sd\">            inherits from :py:class:`DagsterTypeLoader` and can map config data to a value of</span>\n<span class=\"sd\">            this type. Specify this argument if you will need to shim values of this type using the</span>\n<span class=\"sd\">            config machinery. As a rule, you should use the</span>\n<span class=\"sd\">            :py:func:`@dagster_type_loader &lt;dagster.dagster_type_loader&gt;` decorator to construct</span>\n<span class=\"sd\">            these arguments.</span>\n<span class=\"sd\">        materializer (Optional[DagsterTypeMaterializer]): An instance of a class</span>\n<span class=\"sd\">            that inherits from :py:class:`DagsterTypeMaterializer` and can persist values of</span>\n<span class=\"sd\">            this type. As a rule, you should use the</span>\n<span class=\"sd\">            :py:func:`@dagster_type_materializer &lt;dagster.dagster_type_materializer&gt;`</span>\n<span class=\"sd\">            decorator to construct these arguments.</span>\n<span class=\"sd\">        serialization_strategy (Optional[SerializationStrategy]): An instance of a class that</span>\n<span class=\"sd\">            inherits from :py:class:`SerializationStrategy`. The default strategy for serializing</span>\n<span class=\"sd\">            this value when automatically persisting it between execution steps. You should set</span>\n<span class=\"sd\">            this value if the ordinary serialization machinery (e.g., pickle) will not be adequate</span>\n<span class=\"sd\">            for this type.</span>\n<span class=\"sd\">        auto_plugins (Optional[List[TypeStoragePlugin]]): If types must be serialized differently</span>\n<span class=\"sd\">            depending on the storage being used for intermediates, they should specify this</span>\n<span class=\"sd\">            argument. In these cases the serialization_strategy argument is not sufficient because</span>\n<span class=\"sd\">            serialization requires specialized API calls, e.g. to call an S3 API directly instead</span>\n<span class=\"sd\">            of using a generic file object. See ``dagster_pyspark.DataFrame`` for an example.</span>\n\n<span class=\"sd\">    Examples:</span>\n\n<span class=\"sd\">    .. code-block:: python</span>\n\n<span class=\"sd\">        # dagster_aws.s3.file_manager.S3FileHandle</span>\n<span class=\"sd\">        @usable_as_dagster_type</span>\n<span class=\"sd\">        class S3FileHandle(FileHandle):</span>\n<span class=\"sd\">            def __init__(self, s3_bucket, s3_key):</span>\n<span class=\"sd\">                self._s3_bucket = check.str_param(s3_bucket, &#39;s3_bucket&#39;)</span>\n<span class=\"sd\">                self._s3_key = check.str_param(s3_key, &#39;s3_key&#39;)</span>\n\n<span class=\"sd\">            @property</span>\n<span class=\"sd\">            def s3_bucket(self):</span>\n<span class=\"sd\">                return self._s3_bucket</span>\n\n<span class=\"sd\">            @property</span>\n<span class=\"sd\">            def s3_key(self):</span>\n<span class=\"sd\">                return self._s3_key</span>\n\n<span class=\"sd\">            @property</span>\n<span class=\"sd\">            def path_desc(self):</span>\n<span class=\"sd\">                return self.s3_path</span>\n\n<span class=\"sd\">            @property</span>\n<span class=\"sd\">            def s3_path(self):</span>\n<span class=\"sd\">                return &#39;s3://{bucket}/{key}&#39;.format(bucket=self.s3_bucket, key=self.s3_key)</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_with_args</span><span class=\"p\">(</span><span class=\"n\">bare_cls</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">type_param</span><span class=\"p\">(</span><span class=\"n\">bare_cls</span><span class=\"p\">,</span> <span class=\"s2\">&quot;bare_cls&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">new_name</span> <span class=\"o\">=</span> <span class=\"n\">name</span> <span class=\"k\">if</span> <span class=\"n\">name</span> <span class=\"k\">else</span> <span class=\"n\">bare_cls</span><span class=\"o\">.</span><span class=\"vm\">__name__</span>\n\n        <span class=\"n\">make_python_type_usable_as_dagster_type</span><span class=\"p\">(</span>\n            <span class=\"n\">bare_cls</span><span class=\"p\">,</span>\n            <span class=\"n\">PythonObjectDagsterType</span><span class=\"p\">(</span>\n                <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">new_name</span><span class=\"p\">,</span>\n                <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"n\">description</span><span class=\"p\">,</span>\n                <span class=\"n\">python_type</span><span class=\"o\">=</span><span class=\"n\">bare_cls</span><span class=\"p\">,</span>\n                <span class=\"n\">loader</span><span class=\"o\">=</span><span class=\"n\">canonicalize_backcompat_args</span><span class=\"p\">(</span>\n                    <span class=\"n\">loader</span><span class=\"p\">,</span> <span class=\"s2\">&quot;loader&quot;</span><span class=\"p\">,</span> <span class=\"n\">input_hydration_config</span><span class=\"p\">,</span> <span class=\"s2\">&quot;input_hydration_config&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">,</span>\n                <span class=\"p\">),</span>\n                <span class=\"n\">materializer</span><span class=\"o\">=</span><span class=\"n\">canonicalize_backcompat_args</span><span class=\"p\">(</span>\n                    <span class=\"n\">materializer</span><span class=\"p\">,</span>\n                    <span class=\"s2\">&quot;materializer&quot;</span><span class=\"p\">,</span>\n                    <span class=\"n\">output_materialization_config</span><span class=\"p\">,</span>\n                    <span class=\"s2\">&quot;output_materialization_config&quot;</span><span class=\"p\">,</span>\n                    <span class=\"s2\">&quot;0.10.0&quot;</span><span class=\"p\">,</span>\n                <span class=\"p\">),</span>\n                <span class=\"n\">serialization_strategy</span><span class=\"o\">=</span><span class=\"n\">serialization_strategy</span><span class=\"p\">,</span>\n                <span class=\"n\">auto_plugins</span><span class=\"o\">=</span><span class=\"n\">auto_plugins</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">bare_cls</span>\n\n    <span class=\"c1\"># check for no args, no parens case</span>\n    <span class=\"k\">if</span> <span class=\"n\">callable</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"p\">):</span>\n        <span class=\"n\">bare_cls</span> <span class=\"o\">=</span> <span class=\"n\">name</span>  <span class=\"c1\"># with no parens, name is actually the decorated class</span>\n        <span class=\"n\">make_python_type_usable_as_dagster_type</span><span class=\"p\">(</span>\n            <span class=\"n\">bare_cls</span><span class=\"p\">,</span>\n            <span class=\"n\">PythonObjectDagsterType</span><span class=\"p\">(</span><span class=\"n\">python_type</span><span class=\"o\">=</span><span class=\"n\">bare_cls</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">bare_cls</span><span class=\"o\">.</span><span class=\"vm\">__name__</span><span class=\"p\">,</span> <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">bare_cls</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">_with_args</span></div>\n</pre></div>", "current_page_name": "_modules/dagster/core/types/decorator", "sidebars": ["globaltoc.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}