{"parents": [{"link": "../../../", "title": "Module code"}], "title": "dagster.core.events", "body": "<h1>Source code for dagster.core.events</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"sd\">&quot;&quot;&quot;Structured representations of system events.&quot;&quot;&quot;</span>\n<span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n<span class=\"kn\">from</span> <span class=\"nn\">collections</span> <span class=\"kn\">import</span> <span class=\"n\">namedtuple</span>\n<span class=\"kn\">from</span> <span class=\"nn\">enum</span> <span class=\"kn\">import</span> <span class=\"n\">Enum</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dagster</span> <span class=\"kn\">import</span> <span class=\"n\">check</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">AssetMaterialization</span><span class=\"p\">,</span>\n    <span class=\"n\">EventMetadataEntry</span><span class=\"p\">,</span>\n    <span class=\"n\">ExpectationResult</span><span class=\"p\">,</span>\n    <span class=\"n\">Materialization</span><span class=\"p\">,</span>\n    <span class=\"n\">SolidHandle</span><span class=\"p\">,</span>\n    <span class=\"n\">TypeCheck</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.events</span> <span class=\"kn\">import</span> <span class=\"n\">AssetStoreOperationType</span><span class=\"p\">,</span> <span class=\"n\">ObjectStoreOperationType</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.context.system</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">HookContext</span><span class=\"p\">,</span>\n    <span class=\"n\">SystemExecutionContext</span><span class=\"p\">,</span>\n    <span class=\"n\">SystemStepExecutionContext</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">StepOutputData</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.log_manager</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterLogManager</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.serdes</span> <span class=\"kn\">import</span> <span class=\"n\">register_serdes_tuple_fallbacks</span><span class=\"p\">,</span> <span class=\"n\">whitelist_for_serdes</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils.error</span> <span class=\"kn\">import</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">,</span> <span class=\"n\">serializable_error_info_from_exc_info</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils.timing</span> <span class=\"kn\">import</span> <span class=\"n\">format_duration</span>\n\n\n<div class=\"viewcode-block\" id=\"DagsterEventType\"><a class=\"viewcode-back\" href=\"../../../../sections/api/apidocs/execution/#dagster.DagsterEventType\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">DagsterEventType</span><span class=\"p\">(</span><span class=\"n\">Enum</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;The types of events that may be yielded by solid and pipeline execution.&quot;&quot;&quot;</span>\n\n    <span class=\"n\">STEP_OUTPUT</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_OUTPUT&quot;</span>\n    <span class=\"n\">STEP_INPUT</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_INPUT&quot;</span>\n    <span class=\"n\">STEP_FAILURE</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_FAILURE&quot;</span>\n    <span class=\"n\">STEP_START</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_START&quot;</span>\n    <span class=\"n\">STEP_SUCCESS</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_SUCCESS&quot;</span>\n    <span class=\"n\">STEP_SKIPPED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_SKIPPED&quot;</span>\n\n    <span class=\"n\">STEP_UP_FOR_RETRY</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_UP_FOR_RETRY&quot;</span>  <span class=\"c1\"># &quot;failed&quot; but want to retry</span>\n    <span class=\"n\">STEP_RESTARTED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_RESTARTED&quot;</span>\n\n    <span class=\"n\">STEP_MATERIALIZATION</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_MATERIALIZATION&quot;</span>\n    <span class=\"n\">STEP_EXPECTATION_RESULT</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;STEP_EXPECTATION_RESULT&quot;</span>\n\n    <span class=\"n\">PIPELINE_INIT_FAILURE</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;PIPELINE_INIT_FAILURE&quot;</span>\n\n    <span class=\"n\">PIPELINE_ENQUEUED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;PIPELINE_ENQUEUED&quot;</span>\n    <span class=\"n\">PIPELINE_DEQUEUED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;PIPELINE_DEQUEUED&quot;</span>\n    <span class=\"n\">PIPELINE_START</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;PIPELINE_START&quot;</span>\n    <span class=\"n\">PIPELINE_SUCCESS</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;PIPELINE_SUCCESS&quot;</span>\n    <span class=\"n\">PIPELINE_FAILURE</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;PIPELINE_FAILURE&quot;</span>\n\n    <span class=\"n\">OBJECT_STORE_OPERATION</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;OBJECT_STORE_OPERATION&quot;</span>\n    <span class=\"n\">ASSET_STORE_OPERATION</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;ASSET_STORE_OPERATION&quot;</span>\n\n    <span class=\"n\">ENGINE_EVENT</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;ENGINE_EVENT&quot;</span>\n\n    <span class=\"n\">HOOK_COMPLETED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;HOOK_COMPLETED&quot;</span>\n    <span class=\"n\">HOOK_ERRORED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;HOOK_ERRORED&quot;</span>\n    <span class=\"n\">HOOK_SKIPPED</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;HOOK_SKIPPED&quot;</span></div>\n\n\n<span class=\"n\">STEP_EVENTS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_INPUT</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_START</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_OUTPUT</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_FAILURE</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SUCCESS</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SKIPPED</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_MATERIALIZATION</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_EXPECTATION_RESULT</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">OBJECT_STORE_OPERATION</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_RESTARTED</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_UP_FOR_RETRY</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">FAILURE_EVENTS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_INIT_FAILURE</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_FAILURE</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_FAILURE</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">PIPELINE_EVENTS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_ENQUEUED</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_DEQUEUED</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_START</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_SUCCESS</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_FAILURE</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">HOOK_EVENTS</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_COMPLETED</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_ERRORED</span><span class=\"p\">,</span>\n    <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_SKIPPED</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_assert_type</span><span class=\"p\">(</span><span class=\"n\">method</span><span class=\"p\">,</span> <span class=\"n\">expected_type</span><span class=\"p\">,</span> <span class=\"n\">actual_type</span><span class=\"p\">):</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">invariant</span><span class=\"p\">(</span>\n        <span class=\"n\">expected_type</span> <span class=\"o\">==</span> <span class=\"n\">actual_type</span><span class=\"p\">,</span>\n        <span class=\"p\">(</span>\n            <span class=\"s2\">&quot;</span><span class=\"si\">{method}</span><span class=\"s2\"> only callable when event_type is </span><span class=\"si\">{expected_type}</span><span class=\"s2\">, called on </span><span class=\"si\">{actual_type}</span><span class=\"s2\">&quot;</span>\n        <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">method</span><span class=\"o\">=</span><span class=\"n\">method</span><span class=\"p\">,</span> <span class=\"n\">expected_type</span><span class=\"o\">=</span><span class=\"n\">expected_type</span><span class=\"p\">,</span> <span class=\"n\">actual_type</span><span class=\"o\">=</span><span class=\"n\">actual_type</span><span class=\"p\">),</span>\n    <span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_validate_event_specific_data</span><span class=\"p\">(</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"p\">):</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">StepFailureData</span><span class=\"p\">,</span> <span class=\"n\">StepSuccessData</span><span class=\"p\">,</span> <span class=\"n\">StepInputData</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_OUTPUT</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepOutputData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_FAILURE</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepFailureData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SUCCESS</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepSuccessData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_MATERIALIZATION</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepMaterializationData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_EXPECTATION_RESULT</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepExpectationResultData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_INPUT</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepInputData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">EngineEventData</span><span class=\"p\">)</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_ERRORED</span><span class=\"p\">:</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_specific_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">HookErroredData</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">event_specific_data</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">log_step_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">):</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_context&quot;</span><span class=\"p\">,</span> <span class=\"n\">SystemStepExecutionContext</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">)</span>\n\n    <span class=\"n\">event_type</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEventType</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">event_type_value</span><span class=\"p\">)</span>\n    <span class=\"n\">log_fn</span> <span class=\"o\">=</span> <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">error</span> <span class=\"k\">if</span> <span class=\"n\">event_type</span> <span class=\"ow\">in</span> <span class=\"n\">FAILURE_EVENTS</span> <span class=\"k\">else</span> <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">debug</span>\n\n    <span class=\"n\">log_fn</span><span class=\"p\">(</span>\n        <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span>\n        <span class=\"ow\">or</span> <span class=\"s2\">&quot;</span><span class=\"si\">{event_type}</span><span class=\"s2\"> for step </span><span class=\"si\">{step_key}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span>\n        <span class=\"p\">),</span>\n        <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span>\n        <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">log_pipeline_event</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"p\">):</span>\n    <span class=\"n\">event_type</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEventType</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">event_type_value</span><span class=\"p\">)</span>\n\n    <span class=\"n\">log_fn</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n        <span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">error</span> <span class=\"k\">if</span> <span class=\"n\">event_type</span> <span class=\"ow\">in</span> <span class=\"n\">FAILURE_EVENTS</span> <span class=\"k\">else</span> <span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">debug</span>\n    <span class=\"p\">)</span>\n\n    <span class=\"n\">log_fn</span><span class=\"p\">(</span>\n        <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span>\n        <span class=\"ow\">or</span> <span class=\"s2\">&quot;</span><span class=\"si\">{event_type}</span><span class=\"s2\"> for pipeline </span><span class=\"si\">{pipeline_name}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span>\n        <span class=\"p\">),</span>\n        <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span>\n        <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n        <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_key</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">log_resource_event</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">):</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span> <span class=\"n\">EngineEventData</span><span class=\"p\">)</span>\n\n    <span class=\"n\">log_fn</span> <span class=\"o\">=</span> <span class=\"n\">log_manager</span><span class=\"o\">.</span><span class=\"n\">error</span> <span class=\"k\">if</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span><span class=\"o\">.</span><span class=\"n\">error</span> <span class=\"k\">else</span> <span class=\"n\">log_manager</span><span class=\"o\">.</span><span class=\"n\">debug</span>\n    <span class=\"n\">log_fn</span><span class=\"p\">(</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">step_key</span><span class=\"p\">)</span>\n\n\n<div class=\"viewcode-block\" id=\"DagsterEvent\"><a class=\"viewcode-back\" href=\"../../../../sections/api/apidocs/execution/#dagster.DagsterEvent\">[docs]</a><span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">DagsterEvent</span><span class=\"p\">(</span>\n    <span class=\"n\">namedtuple</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;_DagsterEvent&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;event_type_value pipeline_name step_key solid_handle step_kind_value &quot;</span>\n        <span class=\"s2\">&quot;logging_tags event_specific_data message pid&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n<span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Events yielded by solid and pipeline execution.</span>\n\n<span class=\"sd\">    Users should not instantiate this class.</span>\n\n<span class=\"sd\">    Attributes:</span>\n<span class=\"sd\">        event_type_value (str): Value for a DagsterEventType.</span>\n<span class=\"sd\">        pipeline_name (str)</span>\n<span class=\"sd\">        step_key (str)</span>\n<span class=\"sd\">        solid_handle (SolidHandle)</span>\n<span class=\"sd\">        step_kind_value (str): Value for a StepKind.</span>\n<span class=\"sd\">        logging_tags (Dict[str, str])</span>\n<span class=\"sd\">        event_specific_data (Any): Type must correspond to event_type_value.</span>\n<span class=\"sd\">        message (str)</span>\n<span class=\"sd\">        pid (int)</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">from_step</span><span class=\"p\">(</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_context&quot;</span><span class=\"p\">,</span> <span class=\"n\">SystemStepExecutionContext</span><span class=\"p\">)</span>\n\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_type&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">kind</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span><span class=\"p\">,</span>\n            <span class=\"n\">_validate_event_specific_data</span><span class=\"p\">(</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"s2\">&quot;message&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">pid</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getpid</span><span class=\"p\">(),</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">log_step_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">event</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">from_pipeline</span><span class=\"p\">(</span>\n        <span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">pipeline_context</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"kc\">None</span>\n    <span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pipeline_context&quot;</span><span class=\"p\">,</span> <span class=\"n\">SystemExecutionContext</span><span class=\"p\">)</span>\n\n        <span class=\"n\">pipeline_name</span> <span class=\"o\">=</span> <span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span>\n\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_type&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pipeline_name&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"s2\">&quot;message&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">_validate_event_specific_data</span><span class=\"p\">(</span><span class=\"n\">event_type</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"p\">),</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_key</span><span class=\"p\">,</span>\n            <span class=\"n\">pid</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getpid</span><span class=\"p\">(),</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">log_pipeline_event</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">event</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">from_resource</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.plan</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionPlan</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_plan&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionPlan</span><span class=\"p\">)</span>\n        <span class=\"n\">pipeline_name</span> <span class=\"o\">=</span> <span class=\"n\">execution_plan</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span>\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"s2\">&quot;message&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">_validate_event_specific_data</span><span class=\"p\">(</span>\n                <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">execution_plan</span><span class=\"o\">.</span><span class=\"n\">step_key_for_single_step_plans</span><span class=\"p\">(),</span>\n            <span class=\"n\">pid</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getpid</span><span class=\"p\">(),</span>\n        <span class=\"p\">)</span>\n        <span class=\"n\">log_resource_event</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">event</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span>\n        <span class=\"bp\">cls</span><span class=\"p\">,</span>\n        <span class=\"n\">event_type_value</span><span class=\"p\">,</span>\n        <span class=\"n\">pipeline_name</span><span class=\"p\">,</span>\n        <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">solid_handle</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">step_kind_value</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">logging_tags</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">pid</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"p\">):</span>\n        <span class=\"n\">event_type_value</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span> <span class=\"o\">=</span> <span class=\"n\">_handle_back_compat</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type_value</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">DagsterEvent</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">event_type_value</span><span class=\"p\">,</span> <span class=\"s2\">&quot;event_type_value&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pipeline_name&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">step_key</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_key&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_inst_param</span><span class=\"p\">(</span><span class=\"n\">solid_handle</span><span class=\"p\">,</span> <span class=\"s2\">&quot;solid_handle&quot;</span><span class=\"p\">,</span> <span class=\"n\">SolidHandle</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">step_kind_value</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_kind_value&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_dict_param</span><span class=\"p\">(</span><span class=\"n\">logging_tags</span><span class=\"p\">,</span> <span class=\"s2\">&quot;logging_tags&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">_validate_event_specific_data</span><span class=\"p\">(</span><span class=\"n\">DagsterEventType</span><span class=\"p\">(</span><span class=\"n\">event_type_value</span><span class=\"p\">),</span> <span class=\"n\">event_specific_data</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"s2\">&quot;message&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_int_param</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pid&quot;</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid_name</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"o\">.</span><span class=\"n\">name</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">event_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;DagsterEventType: The type of this event.&quot;&quot;&quot;</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEventType</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type_value</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_event</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"ow\">in</span> <span class=\"n\">STEP_EVENTS</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_hook_event</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"ow\">in</span> <span class=\"n\">HOOK_EVENTS</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_kind</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">StepKind</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">StepKind</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">step_kind_value</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_success</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SUCCESS</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_successful_output</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_OUTPUT</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_start</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_START</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_failure</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_FAILURE</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_skipped</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SKIPPED</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_up_for_retry</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_UP_FOR_RETRY</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_restarted</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_RESTARTED</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_pipeline_success</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_SUCCESS</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_pipeline_failure</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_FAILURE</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_pipeline_init_failure</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_INIT_FAILURE</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_failure</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"ow\">in</span> <span class=\"n\">FAILURE_EVENTS</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_pipeline_event</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"ow\">in</span> <span class=\"n\">PIPELINE_EVENTS</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_engine_event</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_asset_store_operation</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ASSET_STORE_OPERATION</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_step_materialization</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_MATERIALIZATION</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">asset_key</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">!=</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_MATERIALIZATION</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"kc\">None</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">step_materialization_data</span><span class=\"o\">.</span><span class=\"n\">materialization</span><span class=\"o\">.</span><span class=\"n\">asset_key</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_input_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;step_input_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_INPUT</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_output_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;step_output_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_OUTPUT</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_success_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;step_success_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SUCCESS</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_failure_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;step_failure_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_FAILURE</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_retry_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;step_retry_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_UP_FOR_RETRY</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_materialization_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;step_materialization_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_MATERIALIZATION</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_expectation_result_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;step_expectation_result_data&quot;</span><span class=\"p\">,</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_EXPECTATION_RESULT</span><span class=\"p\">,</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_init_failure_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;pipeline_init_failure_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_INIT_FAILURE</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_failure_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;pipeline_failure_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_FAILURE</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">engine_event_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;engine_event_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_completed_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;hook_completed_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_COMPLETED</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_errored_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;hook_errored_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_ERRORED</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_skipped_data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">_assert_type</span><span class=\"p\">(</span><span class=\"s2\">&quot;hook_skipped_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_SKIPPED</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_type</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">event_specific_data</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_output_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">step_output_data</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step_output_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_output_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepOutputData</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_OUTPUT</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">step_output_data</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Yielded output &quot;</span><span class=\"si\">{output_name}</span><span class=\"s1\">&quot; of type &quot;</span><span class=\"si\">{output_type}</span><span class=\"s1\">&quot;.</span><span class=\"si\">{type_check_clause}</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"n\">step_output_data</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">output_name</span><span class=\"p\">,</span>\n                <span class=\"n\">output_type</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">step_output_named</span><span class=\"p\">(</span>\n                    <span class=\"n\">step_output_data</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">output_name</span>\n                <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">display_name</span><span class=\"p\">,</span>\n                <span class=\"n\">type_check_clause</span><span class=\"o\">=</span><span class=\"p\">(</span>\n                    <span class=\"s2\">&quot; Warning! Type check failed.&quot;</span>\n                    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">step_output_data</span><span class=\"o\">.</span><span class=\"n\">type_check_data</span><span class=\"o\">.</span><span class=\"n\">success</span>\n                    <span class=\"k\">else</span> <span class=\"s2\">&quot; (Type check passed).&quot;</span>\n                <span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">step_output_data</span><span class=\"o\">.</span><span class=\"n\">type_check_data</span>\n                <span class=\"k\">else</span> <span class=\"s2\">&quot; (No type check).&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_failure_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">step_failure_data</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_FAILURE</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">step_failure_data</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Execution of step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot; failed.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_retry_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">step_retry_data</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_UP_FOR_RETRY</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">step_retry_data</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Execution of step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot; failed and has requested a retry</span><span class=\"si\">{wait_str}</span><span class=\"s1\">.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n                <span class=\"n\">wait_str</span><span class=\"o\">=</span><span class=\"s2\">&quot; in </span><span class=\"si\">{n}</span><span class=\"s2\"> seconds&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"o\">=</span><span class=\"n\">step_retry_data</span><span class=\"o\">.</span><span class=\"n\">seconds_to_wait</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">step_retry_data</span><span class=\"o\">.</span><span class=\"n\">seconds_to_wait</span>\n                <span class=\"k\">else</span> <span class=\"s2\">&quot;&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_input_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">step_input_data</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_INPUT</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">step_input_data</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Got input &quot;</span><span class=\"si\">{input_name}</span><span class=\"s1\">&quot; of type &quot;</span><span class=\"si\">{input_type}</span><span class=\"s1\">&quot;.</span><span class=\"si\">{type_check_clause}</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">input_name</span><span class=\"o\">=</span><span class=\"n\">step_input_data</span><span class=\"o\">.</span><span class=\"n\">input_name</span><span class=\"p\">,</span>\n                <span class=\"n\">input_type</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">step_input_named</span><span class=\"p\">(</span>\n                    <span class=\"n\">step_input_data</span><span class=\"o\">.</span><span class=\"n\">input_name</span>\n                <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">display_name</span><span class=\"p\">,</span>\n                <span class=\"n\">type_check_clause</span><span class=\"o\">=</span><span class=\"p\">(</span>\n                    <span class=\"s2\">&quot; Warning! Type check failed.&quot;</span>\n                    <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">step_input_data</span><span class=\"o\">.</span><span class=\"n\">type_check_data</span><span class=\"o\">.</span><span class=\"n\">success</span>\n                    <span class=\"k\">else</span> <span class=\"s2\">&quot; (Type check passed).&quot;</span>\n                <span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">step_input_data</span><span class=\"o\">.</span><span class=\"n\">type_check_data</span>\n                <span class=\"k\">else</span> <span class=\"s2\">&quot; (No type check).&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_start_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_START</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Started execution of step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot;.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_restarted_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">previous_attempts</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_RESTARTED</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Started re-execution (attempt # </span><span class=\"si\">{n}</span><span class=\"s1\">) of step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot;.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">n</span><span class=\"o\">=</span><span class=\"n\">previous_attempts</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_success_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">success</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SUCCESS</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">success</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Finished execution of step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot; in </span><span class=\"si\">{duration}</span><span class=\"s1\">.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"c1\"># TODO: Make duration human readable</span>\n                <span class=\"c1\"># See: https://github.com/dagster-io/dagster/issues/1602</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n                <span class=\"n\">duration</span><span class=\"o\">=</span><span class=\"n\">format_duration</span><span class=\"p\">(</span><span class=\"n\">success</span><span class=\"o\">.</span><span class=\"n\">duration_ms</span><span class=\"p\">),</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_skipped_event</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_SKIPPED</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Skipped execution of step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot;.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_materialization</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">materialization</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n            <span class=\"n\">materialization</span><span class=\"p\">,</span> <span class=\"s2\">&quot;materialization&quot;</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">AssetMaterialization</span><span class=\"p\">,</span> <span class=\"n\">Materialization</span><span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_MATERIALIZATION</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">StepMaterializationData</span><span class=\"p\">(</span><span class=\"n\">materialization</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">materialization</span><span class=\"o\">.</span><span class=\"n\">description</span>\n            <span class=\"k\">if</span> <span class=\"n\">materialization</span><span class=\"o\">.</span><span class=\"n\">description</span>\n            <span class=\"k\">else</span> <span class=\"s2\">&quot;Materialized value</span><span class=\"si\">{label_clause}</span><span class=\"s2\">.&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">label_clause</span><span class=\"o\">=</span><span class=\"s2\">&quot; </span><span class=\"si\">{label}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"o\">=</span><span class=\"n\">materialization</span><span class=\"o\">.</span><span class=\"n\">label</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"n\">materialization</span><span class=\"o\">.</span><span class=\"n\">label</span>\n                <span class=\"k\">else</span> <span class=\"s2\">&quot;&quot;</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_expectation_result</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">expectation_result</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">expectation_result</span><span class=\"p\">,</span> <span class=\"s2\">&quot;expectation_result&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExpectationResult</span><span class=\"p\">)</span>\n\n        <span class=\"k\">def</span> <span class=\"nf\">_msg</span><span class=\"p\">():</span>\n            <span class=\"k\">if</span> <span class=\"n\">expectation_result</span><span class=\"o\">.</span><span class=\"n\">description</span><span class=\"p\">:</span>\n                <span class=\"k\">return</span> <span class=\"n\">expectation_result</span><span class=\"o\">.</span><span class=\"n\">description</span>\n\n            <span class=\"k\">return</span> <span class=\"s2\">&quot;Expectation</span><span class=\"si\">{label_clause}</span><span class=\"s2\"> </span><span class=\"si\">{result_verb}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">label_clause</span><span class=\"o\">=</span><span class=\"s2\">&quot; &quot;</span> <span class=\"o\">+</span> <span class=\"n\">expectation_result</span><span class=\"o\">.</span><span class=\"n\">label</span> <span class=\"k\">if</span> <span class=\"n\">expectation_result</span><span class=\"o\">.</span><span class=\"n\">label</span> <span class=\"k\">else</span> <span class=\"s2\">&quot;&quot;</span><span class=\"p\">,</span>\n                <span class=\"n\">result_verb</span><span class=\"o\">=</span><span class=\"s2\">&quot;passed&quot;</span> <span class=\"k\">if</span> <span class=\"n\">expectation_result</span><span class=\"o\">.</span><span class=\"n\">success</span> <span class=\"k\">else</span> <span class=\"s2\">&quot;failed&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_EXPECTATION_RESULT</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">StepExpectationResultData</span><span class=\"p\">(</span><span class=\"n\">expectation_result</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">_msg</span><span class=\"p\">(),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_start</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_pipeline</span><span class=\"p\">(</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_START</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Started execution of pipeline &quot;</span><span class=\"si\">{pipeline_name}</span><span class=\"s1\">&quot;.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_success</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_pipeline</span><span class=\"p\">(</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_SUCCESS</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Finished execution of pipeline &quot;</span><span class=\"si\">{pipeline_name}</span><span class=\"s1\">&quot;.&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_failure</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">,</span> <span class=\"n\">context_msg</span><span class=\"p\">,</span> <span class=\"n\">error_info</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_pipeline</span><span class=\"p\">(</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_FAILURE</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s1\">&#39;Execution of pipeline &quot;</span><span class=\"si\">{pipeline_name}</span><span class=\"s1\">&quot; failed. </span><span class=\"si\">{context_msg}</span><span class=\"s1\">&#39;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n                <span class=\"n\">context_msg</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">context_msg</span><span class=\"p\">,</span> <span class=\"s2\">&quot;context_msg&quot;</span><span class=\"p\">),</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">PipelineFailureData</span><span class=\"p\">(</span>\n                <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_inst_param</span><span class=\"p\">(</span><span class=\"n\">error_info</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error_info&quot;</span><span class=\"p\">,</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">)</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resource_init_start</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">resource_keys</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.plan</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionPlan</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_resource</span><span class=\"p\">(</span>\n            <span class=\"n\">execution_plan</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_plan&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionPlan</span><span class=\"p\">),</span>\n            <span class=\"n\">log_manager</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s2\">&quot;Starting initialization of resources [</span><span class=\"si\">{}</span><span class=\"s2\">].&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"n\">resource_keys</span><span class=\"p\">))</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">EngineEventData</span><span class=\"p\">(</span><span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[],</span> <span class=\"n\">marker_start</span><span class=\"o\">=</span><span class=\"s2\">&quot;resources&quot;</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resource_init_success</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">resource_instances</span><span class=\"p\">,</span> <span class=\"n\">resource_init_times</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.plan</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionPlan</span>\n\n        <span class=\"n\">metadata_entries</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"k\">for</span> <span class=\"n\">resource_key</span> <span class=\"ow\">in</span> <span class=\"n\">resource_instances</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">():</span>\n            <span class=\"n\">resource_obj</span> <span class=\"o\">=</span> <span class=\"n\">resource_instances</span><span class=\"p\">[</span><span class=\"n\">resource_key</span><span class=\"p\">]</span>\n            <span class=\"n\">resource_time</span> <span class=\"o\">=</span> <span class=\"n\">resource_init_times</span><span class=\"p\">[</span><span class=\"n\">resource_key</span><span class=\"p\">]</span>\n            <span class=\"n\">metadata_entries</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span>\n                <span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">python_artifact</span><span class=\"p\">(</span>\n                    <span class=\"n\">resource_obj</span><span class=\"o\">.</span><span class=\"vm\">__class__</span><span class=\"p\">,</span> <span class=\"n\">resource_key</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Initialized in </span><span class=\"si\">{}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">resource_time</span><span class=\"p\">)</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_resource</span><span class=\"p\">(</span>\n            <span class=\"n\">execution_plan</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_plan&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionPlan</span><span class=\"p\">),</span>\n            <span class=\"n\">log_manager</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s2\">&quot;Finished initialization of resources [</span><span class=\"si\">{}</span><span class=\"s2\">].&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"n\">resource_init_times</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">()))</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">EngineEventData</span><span class=\"p\">(</span>\n                <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"n\">metadata_entries</span><span class=\"p\">,</span> <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"s2\">&quot;resources&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resource_init_failure</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">resource_keys</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.plan</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionPlan</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_resource</span><span class=\"p\">(</span>\n            <span class=\"n\">execution_plan</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_plan&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionPlan</span><span class=\"p\">),</span>\n            <span class=\"n\">log_manager</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s2\">&quot;Initialization of resources [</span><span class=\"si\">{}</span><span class=\"s2\">] failed.&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">resource_keys</span><span class=\"p\">)),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">EngineEventData</span><span class=\"p\">(</span>\n                <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[],</span> <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"s2\">&quot;resources&quot;</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">error</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resource_teardown_failure</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">resource_keys</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.plan</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionPlan</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_resource</span><span class=\"p\">(</span>\n            <span class=\"n\">execution_plan</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_plan&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionPlan</span><span class=\"p\">),</span>\n            <span class=\"n\">log_manager</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"s2\">&quot;Teardown of resources [</span><span class=\"si\">{}</span><span class=\"s2\">] failed.&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"s2\">&quot;, &quot;</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">resource_keys</span><span class=\"p\">)),</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">EngineEventData</span><span class=\"p\">(</span>\n                <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[],</span> <span class=\"n\">marker_start</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">error</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_init_failure</span><span class=\"p\">(</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"n\">failure_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">failure_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;failure_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">PipelineInitFailureData</span><span class=\"p\">)</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">)</span>\n        <span class=\"c1\"># this failure happens trying to bring up context so can&#39;t use from_pipeline</span>\n\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type_value</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_INIT_FAILURE</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">failure_data</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"p\">(</span>\n                <span class=\"s1\">&#39;Pipeline failure during initialization of pipeline &quot;</span><span class=\"si\">{pipeline_name}</span><span class=\"s1\">&quot;. &#39;</span>\n                <span class=\"s2\">&quot;This may be due to a failure in initializing a resource or logger.&quot;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_name</span><span class=\"p\">),</span>\n            <span class=\"n\">pid</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getpid</span><span class=\"p\">(),</span>\n        <span class=\"p\">)</span>\n        <span class=\"n\">log_manager</span><span class=\"o\">.</span><span class=\"n\">error</span><span class=\"p\">(</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span>\n            <span class=\"ow\">or</span> <span class=\"s2\">&quot;</span><span class=\"si\">{event_type}</span><span class=\"s2\"> for pipeline </span><span class=\"si\">{pipeline_name}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">PIPELINE_INIT_FAILURE</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_name</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">event</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">engine_event</span><span class=\"p\">(</span><span class=\"n\">pipeline_context</span><span class=\"p\">,</span> <span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_pipeline</span><span class=\"p\">(</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_context</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">event_specific_data</span><span class=\"p\">,</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_key</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">object_store_operation</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">object_store_operation_result</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.events</span> <span class=\"kn\">import</span> <span class=\"n\">ObjectStoreOperation</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n            <span class=\"n\">object_store_operation_result</span><span class=\"p\">,</span> <span class=\"s2\">&quot;object_store_operation_result&quot;</span><span class=\"p\">,</span> <span class=\"n\">ObjectStoreOperation</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">object_store_name</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n            <span class=\"s2\">&quot;</span><span class=\"si\">{object_store_name}</span><span class=\"s2\"> &quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">object_store_name</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">object_store_name</span>\n            <span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">object_store_name</span>\n            <span class=\"k\">else</span> <span class=\"s2\">&quot;&quot;</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">serialization_strategy_modifier</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n            <span class=\"s2\">&quot; using </span><span class=\"si\">{serialization_strategy_name}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">serialization_strategy_name</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">serialization_strategy_name</span>\n            <span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">serialization_strategy_name</span>\n            <span class=\"k\">else</span> <span class=\"s2\">&quot;&quot;</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">value_name</span> <span class=\"o\">=</span> <span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">value_name</span>\n\n        <span class=\"k\">if</span> <span class=\"p\">(</span>\n            <span class=\"n\">ObjectStoreOperationType</span><span class=\"p\">(</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"o\">==</span> <span class=\"n\">ObjectStoreOperationType</span><span class=\"o\">.</span><span class=\"n\">SET_OBJECT</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n                <span class=\"s2\">&quot;Stored intermediate object for output </span><span class=\"si\">{value_name}</span><span class=\"s2\"> in &quot;</span>\n                <span class=\"s2\">&quot;</span><span class=\"si\">{object_store_name}</span><span class=\"s2\">object store</span><span class=\"si\">{serialization_strategy_modifier}</span><span class=\"s2\">.&quot;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">value_name</span><span class=\"o\">=</span><span class=\"n\">value_name</span><span class=\"p\">,</span>\n                <span class=\"n\">object_store_name</span><span class=\"o\">=</span><span class=\"n\">object_store_name</span><span class=\"p\">,</span>\n                <span class=\"n\">serialization_strategy_modifier</span><span class=\"o\">=</span><span class=\"n\">serialization_strategy_modifier</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"p\">(</span>\n            <span class=\"n\">ObjectStoreOperationType</span><span class=\"p\">(</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"o\">==</span> <span class=\"n\">ObjectStoreOperationType</span><span class=\"o\">.</span><span class=\"n\">GET_OBJECT</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n                <span class=\"s2\">&quot;Retrieved intermediate object for input </span><span class=\"si\">{value_name}</span><span class=\"s2\"> in &quot;</span>\n                <span class=\"s2\">&quot;</span><span class=\"si\">{object_store_name}</span><span class=\"s2\">object store</span><span class=\"si\">{serialization_strategy_modifier}</span><span class=\"s2\">.&quot;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">value_name</span><span class=\"o\">=</span><span class=\"n\">value_name</span><span class=\"p\">,</span>\n                <span class=\"n\">object_store_name</span><span class=\"o\">=</span><span class=\"n\">object_store_name</span><span class=\"p\">,</span>\n                <span class=\"n\">serialization_strategy_modifier</span><span class=\"o\">=</span><span class=\"n\">serialization_strategy_modifier</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"p\">(</span>\n            <span class=\"n\">ObjectStoreOperationType</span><span class=\"p\">(</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"o\">==</span> <span class=\"n\">ObjectStoreOperationType</span><span class=\"o\">.</span><span class=\"n\">CP_OBJECT</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n                <span class=\"s2\">&quot;Copied intermediate object for input </span><span class=\"si\">{value_name}</span><span class=\"s2\"> from </span><span class=\"si\">{key}</span><span class=\"s2\"> to </span><span class=\"si\">{dest_key}</span><span class=\"s2\">&quot;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">value_name</span><span class=\"o\">=</span><span class=\"n\">value_name</span><span class=\"p\">,</span>\n                <span class=\"n\">key</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n                <span class=\"n\">dest_key</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">dest_key</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">OBJECT_STORE_OPERATION</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">ObjectStoreOperationResultData</span><span class=\"p\">(</span>\n                <span class=\"n\">op</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">,</span>\n                <span class=\"n\">value_name</span><span class=\"o\">=</span><span class=\"n\">value_name</span><span class=\"p\">,</span>\n                <span class=\"n\">address</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n                <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[</span>\n                    <span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"p\">(</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"o\">=</span><span class=\"s2\">&quot;key&quot;</span><span class=\"p\">)</span>\n                <span class=\"p\">],</span>\n                <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"n\">object_store_operation_result</span><span class=\"o\">.</span><span class=\"n\">version</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">message</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">asset_store_operation</span><span class=\"p\">(</span><span class=\"n\">step_context</span><span class=\"p\">,</span> <span class=\"n\">asset_store_operation</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.events</span> <span class=\"kn\">import</span> <span class=\"n\">AssetStoreOperation</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">asset_store_operation</span><span class=\"p\">,</span> <span class=\"s2\">&quot;asset_store_operation&quot;</span><span class=\"p\">,</span> <span class=\"n\">AssetStoreOperation</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">AssetStoreOperationType</span><span class=\"p\">(</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"n\">AssetStoreOperationType</span><span class=\"o\">.</span><span class=\"n\">SET_ASSET</span><span class=\"p\">:</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n                <span class=\"s1\">&#39;Stored output &quot;</span><span class=\"si\">{output_name}</span><span class=\"s1\">&quot; using asset store &quot;</span><span class=\"si\">{asset_store_key}</span><span class=\"s1\">&quot;.&#39;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">asset_store_key</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">asset_store_handle</span><span class=\"o\">.</span><span class=\"n\">asset_store_key</span><span class=\"p\">,</span>\n                <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">output_name</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"n\">AssetStoreOperationType</span><span class=\"p\">(</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"n\">AssetStoreOperationType</span><span class=\"o\">.</span><span class=\"n\">GET_ASSET</span><span class=\"p\">:</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"p\">(</span>\n                <span class=\"s1\">&#39;Retrieved output &quot;</span><span class=\"si\">{output_name}</span><span class=\"s1\">&quot; from step &quot;</span><span class=\"si\">{step_key}</span><span class=\"s1\">&quot; &#39;</span>\n                <span class=\"s1\">&#39;using asset store &quot;</span><span class=\"si\">{asset_store_key}</span><span class=\"s1\">&quot;.&#39;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">asset_store_key</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">asset_store_handle</span><span class=\"o\">.</span><span class=\"n\">asset_store_key</span><span class=\"p\">,</span>\n                <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">output_name</span><span class=\"p\">,</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">step_key</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">message</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEvent</span><span class=\"o\">.</span><span class=\"n\">from_step</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ASSET_STORE_OPERATION</span><span class=\"p\">,</span>\n            <span class=\"n\">step_context</span><span class=\"o\">=</span><span class=\"n\">step_context</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">AssetStoreOperationData</span><span class=\"p\">(</span>\n                <span class=\"n\">op</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">op</span><span class=\"p\">,</span>\n                <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">step_key</span><span class=\"p\">,</span>\n                <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">output_name</span><span class=\"p\">,</span>\n                <span class=\"n\">asset_store_key</span><span class=\"o\">=</span><span class=\"n\">asset_store_operation</span><span class=\"o\">.</span><span class=\"n\">asset_store_handle</span><span class=\"o\">.</span><span class=\"n\">asset_store_key</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"n\">message</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_completed</span><span class=\"p\">(</span><span class=\"n\">hook_context</span><span class=\"p\">,</span> <span class=\"n\">hook_def</span><span class=\"p\">):</span>\n        <span class=\"n\">event_type</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_COMPLETED</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">hook_context</span><span class=\"p\">,</span> <span class=\"s2\">&quot;hook_context&quot;</span><span class=\"p\">,</span> <span class=\"n\">HookContext</span><span class=\"p\">)</span>\n\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type_value</span><span class=\"o\">=</span><span class=\"n\">event_type</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n            <span class=\"n\">solid_handle</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">,</span>\n            <span class=\"n\">step_kind_value</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">kind</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">logging_tags</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"p\">(</span>\n                <span class=\"s1\">&#39;Finished the execution of hook &quot;</span><span class=\"si\">{hook_name}</span><span class=\"s1\">&quot; triggered for solid &quot;</span><span class=\"si\">{solid_name}</span><span class=\"s1\">&quot;.&#39;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">hook_name</span><span class=\"o\">=</span><span class=\"n\">hook_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">solid_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">solid</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">debug</span><span class=\"p\">(</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">event</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_errored</span><span class=\"p\">(</span><span class=\"n\">hook_context</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"n\">event_type</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_ERRORED</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">hook_context</span><span class=\"p\">,</span> <span class=\"s2\">&quot;hook_context&quot;</span><span class=\"p\">,</span> <span class=\"n\">HookContext</span><span class=\"p\">)</span>\n\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type_value</span><span class=\"o\">=</span><span class=\"n\">event_type</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n            <span class=\"n\">solid_handle</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">,</span>\n            <span class=\"n\">step_kind_value</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">kind</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">logging_tags</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span><span class=\"p\">,</span>\n            <span class=\"n\">event_specific_data</span><span class=\"o\">=</span><span class=\"n\">_validate_event_specific_data</span><span class=\"p\">(</span>\n                <span class=\"n\">event_type</span><span class=\"p\">,</span>\n                <span class=\"n\">HookErroredData</span><span class=\"p\">(</span>\n                    <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">serializable_error_info_from_exc_info</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"o\">.</span><span class=\"n\">original_exc_info</span><span class=\"p\">)</span>\n                <span class=\"p\">),</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">error</span><span class=\"p\">(</span>\n            <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">),</span> <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">event</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_skipped</span><span class=\"p\">(</span><span class=\"n\">hook_context</span><span class=\"p\">,</span> <span class=\"n\">hook_def</span><span class=\"p\">):</span>\n        <span class=\"n\">event_type</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">HOOK_SKIPPED</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">hook_context</span><span class=\"p\">,</span> <span class=\"s2\">&quot;hook_context&quot;</span><span class=\"p\">,</span> <span class=\"n\">HookContext</span><span class=\"p\">)</span>\n\n        <span class=\"n\">event</span> <span class=\"o\">=</span> <span class=\"n\">DagsterEvent</span><span class=\"p\">(</span>\n            <span class=\"n\">event_type_value</span><span class=\"o\">=</span><span class=\"n\">event_type</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">key</span><span class=\"p\">,</span>\n            <span class=\"n\">solid_handle</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">,</span>\n            <span class=\"n\">step_kind_value</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">kind</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span>\n            <span class=\"n\">logging_tags</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span><span class=\"p\">,</span>\n            <span class=\"n\">message</span><span class=\"o\">=</span><span class=\"p\">(</span>\n                <span class=\"s1\">&#39;Skipped the execution of hook &quot;</span><span class=\"si\">{hook_name}</span><span class=\"s1\">&quot;. It did not meet its triggering &#39;</span>\n                <span class=\"s1\">&#39;condition during the execution of solid &quot;</span><span class=\"si\">{solid_name}</span><span class=\"s1\">&quot;.&#39;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">hook_name</span><span class=\"o\">=</span><span class=\"n\">hook_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">solid_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">solid</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"o\">.</span><span class=\"n\">debug</span><span class=\"p\">(</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">message</span><span class=\"p\">,</span> <span class=\"n\">dagster_event</span><span class=\"o\">=</span><span class=\"n\">event</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">hook_context</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">event</span></div>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">get_step_output_event</span><span class=\"p\">(</span><span class=\"n\">events</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"p\">,</span> <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"s2\">&quot;result&quot;</span><span class=\"p\">):</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">list_param</span><span class=\"p\">(</span><span class=\"n\">events</span><span class=\"p\">,</span> <span class=\"s2\">&quot;events&quot;</span><span class=\"p\">,</span> <span class=\"n\">of_type</span><span class=\"o\">=</span><span class=\"n\">DagsterEvent</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">step_key</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_key&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">output_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;output_name&quot;</span><span class=\"p\">)</span>\n    <span class=\"k\">for</span> <span class=\"n\">event</span> <span class=\"ow\">in</span> <span class=\"n\">events</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span>\n            <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">event_type</span> <span class=\"o\">==</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">STEP_OUTPUT</span>\n            <span class=\"ow\">and</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">step_key</span> <span class=\"o\">==</span> <span class=\"n\">step_key</span>\n            <span class=\"ow\">and</span> <span class=\"n\">event</span><span class=\"o\">.</span><span class=\"n\">step_output_data</span><span class=\"o\">.</span><span class=\"n\">output_name</span> <span class=\"o\">==</span> <span class=\"n\">output_name</span>\n        <span class=\"p\">):</span>\n            <span class=\"k\">return</span> <span class=\"n\">event</span>\n    <span class=\"k\">return</span> <span class=\"kc\">None</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">StepMaterializationData</span><span class=\"p\">(</span><span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_StepMaterializationData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;materialization&quot;</span><span class=\"p\">)):</span>\n    <span class=\"k\">pass</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">StepExpectationResultData</span><span class=\"p\">(</span><span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_StepExpectationResultData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;expectation_result&quot;</span><span class=\"p\">)):</span>\n    <span class=\"k\">pass</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">AssetStoreOperationData</span><span class=\"p\">(</span>\n    <span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_AssetStoreOperationData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;op step_key output_name asset_store_key&quot;</span><span class=\"p\">)</span>\n<span class=\"p\">):</span>\n    <span class=\"k\">pass</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">ObjectStoreOperationResultData</span><span class=\"p\">(</span>\n    <span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_ObjectStoreOperationResultData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;op value_name metadata_entries address version&quot;</span><span class=\"p\">)</span>\n<span class=\"p\">):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">op</span><span class=\"p\">,</span> <span class=\"n\">value_name</span><span class=\"p\">,</span> <span class=\"n\">metadata_entries</span><span class=\"p\">,</span> <span class=\"n\">address</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">ObjectStoreOperationResultData</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span>\n            <span class=\"n\">op</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">op</span><span class=\"p\">,</span> <span class=\"s2\">&quot;op&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">value_name</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">value_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;value_name&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_list_param</span><span class=\"p\">(</span><span class=\"n\">metadata_entries</span><span class=\"p\">,</span> <span class=\"s2\">&quot;metadata_entries&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">address</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">address</span><span class=\"p\">,</span> <span class=\"s2\">&quot;address&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">version</span><span class=\"p\">,</span> <span class=\"s2\">&quot;version&quot;</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">EngineEventData</span><span class=\"p\">(</span>\n    <span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_EngineEventData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;metadata_entries error marker_start marker_end&quot;</span><span class=\"p\">)</span>\n<span class=\"p\">):</span>\n    <span class=\"c1\"># serdes log</span>\n    <span class=\"c1\"># * added optional error</span>\n    <span class=\"c1\"># * added marker_start / marker_end</span>\n    <span class=\"c1\">#</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">marker_start</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">EngineEventData</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span>\n            <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_list_param</span><span class=\"p\">(</span>\n                <span class=\"n\">metadata_entries</span><span class=\"p\">,</span> <span class=\"s2\">&quot;metadata_entries&quot;</span><span class=\"p\">,</span> <span class=\"n\">EventMetadataEntry</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_inst_param</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">,</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">),</span>\n            <span class=\"n\">marker_start</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">marker_start</span><span class=\"p\">,</span> <span class=\"s2\">&quot;marker_start&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">marker_end</span><span class=\"p\">,</span> <span class=\"s2\">&quot;marker_end&quot;</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">in_process</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">,</span> <span class=\"n\">step_keys_to_execute</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">int_param</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pid&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_list_param</span><span class=\"p\">(</span><span class=\"n\">step_keys_to_execute</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_keys_to_execute&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">EngineEventData</span><span class=\"p\">(</span>\n            <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">),</span> <span class=\"s2\">&quot;pid&quot;</span><span class=\"p\">)]</span>\n            <span class=\"o\">+</span> <span class=\"p\">(</span>\n                <span class=\"p\">[</span><span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">step_keys_to_execute</span><span class=\"p\">),</span> <span class=\"s2\">&quot;step_keys&quot;</span><span class=\"p\">)]</span>\n                <span class=\"k\">if</span> <span class=\"n\">step_keys_to_execute</span>\n                <span class=\"k\">else</span> <span class=\"p\">[]</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">marker_end</span><span class=\"o\">=</span><span class=\"n\">marker_end</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">multiprocess</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">,</span> <span class=\"n\">step_keys_to_execute</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">int_param</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pid&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_list_param</span><span class=\"p\">(</span><span class=\"n\">step_keys_to_execute</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_keys_to_execute&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">EngineEventData</span><span class=\"p\">(</span>\n            <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">pid</span><span class=\"p\">),</span> <span class=\"s2\">&quot;pid&quot;</span><span class=\"p\">)]</span>\n            <span class=\"o\">+</span> <span class=\"p\">(</span>\n                <span class=\"p\">[</span><span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">step_keys_to_execute</span><span class=\"p\">),</span> <span class=\"s2\">&quot;step_keys&quot;</span><span class=\"p\">)]</span>\n                <span class=\"k\">if</span> <span class=\"n\">step_keys_to_execute</span>\n                <span class=\"k\">else</span> <span class=\"p\">[]</span>\n            <span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">interrupted</span><span class=\"p\">(</span><span class=\"n\">steps_interrupted</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">list_param</span><span class=\"p\">(</span><span class=\"n\">steps_interrupted</span><span class=\"p\">,</span> <span class=\"s2\">&quot;steps_interrupted&quot;</span><span class=\"p\">,</span> <span class=\"nb\">str</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">EngineEventData</span><span class=\"p\">(</span>\n            <span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">EventMetadataEntry</span><span class=\"o\">.</span><span class=\"n\">text</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">steps_interrupted</span><span class=\"p\">),</span> <span class=\"s2\">&quot;steps_interrupted&quot;</span><span class=\"p\">)]</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@staticmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">engine_error</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">,</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">EngineEventData</span><span class=\"p\">(</span><span class=\"n\">metadata_entries</span><span class=\"o\">=</span><span class=\"p\">[],</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">error</span><span class=\"p\">)</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">PipelineInitFailureData</span><span class=\"p\">(</span><span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_PipelineInitFailureData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">)):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">PipelineInitFailureData</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">,</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">PipelineFailureData</span><span class=\"p\">(</span><span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_PipelineFailureData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">)):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">PipelineFailureData</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_inst_param</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">,</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n\n<span class=\"nd\">@whitelist_for_serdes</span>\n<span class=\"k\">class</span> <span class=\"nc\">HookErroredData</span><span class=\"p\">(</span><span class=\"n\">namedtuple</span><span class=\"p\">(</span><span class=\"s2\">&quot;_HookErroredData&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">)):</span>\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span><span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">HookErroredData</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">error</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">error</span><span class=\"p\">,</span> <span class=\"s2\">&quot;error&quot;</span><span class=\"p\">,</span> <span class=\"n\">SerializableErrorInfo</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n\n<span class=\"c1\">###################################################################################################</span>\n<span class=\"c1\"># THE GRAVEYARD</span>\n<span class=\"c1\">#</span>\n<span class=\"c1\">#            -|-</span>\n<span class=\"c1\">#             |</span>\n<span class=\"c1\">#        _-&#39;~~~~~`-_</span>\n<span class=\"c1\">#      .&#39;           &#39;.</span>\n<span class=\"c1\">#      |    R I P    |</span>\n<span class=\"c1\">#      |             |</span>\n<span class=\"c1\">#      |  Synthetic  |</span>\n<span class=\"c1\">#      |   Process   |</span>\n<span class=\"c1\">#      |   Events    |</span>\n<span class=\"c1\">#      |             |</span>\n<span class=\"c1\">###################################################################################################</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_handle_back_compat</span><span class=\"p\">(</span><span class=\"n\">event_type_value</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span><span class=\"p\">):</span>\n    <span class=\"k\">if</span> <span class=\"n\">event_type_value</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;PIPELINE_PROCESS_START&quot;</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span> <span class=\"n\">EngineEventData</span><span class=\"p\">([])</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type_value</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;PIPELINE_PROCESS_STARTED&quot;</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span> <span class=\"n\">EngineEventData</span><span class=\"p\">([])</span>\n    <span class=\"k\">elif</span> <span class=\"n\">event_type_value</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;PIPELINE_PROCESS_EXITED&quot;</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">DagsterEventType</span><span class=\"o\">.</span><span class=\"n\">ENGINE_EVENT</span><span class=\"o\">.</span><span class=\"n\">value</span><span class=\"p\">,</span> <span class=\"n\">EngineEventData</span><span class=\"p\">([])</span>\n    <span class=\"k\">else</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">event_type_value</span><span class=\"p\">,</span> <span class=\"n\">event_specific_data</span>\n\n\n<span class=\"n\">register_serdes_tuple_fallbacks</span><span class=\"p\">(</span>\n    <span class=\"p\">{</span>\n        <span class=\"s2\">&quot;PipelineProcessStartedData&quot;</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;PipelineProcessExitedData&quot;</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;PipelineProcessStartData&quot;</span><span class=\"p\">:</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n<span class=\"p\">)</span>\n</pre></div>", "current_page_name": "_modules/dagster/core/events", "sidebars": ["globaltoc.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}