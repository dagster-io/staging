{"parents": [{"link": "../../../../../", "title": "Module code"}], "title": "dagster.core.execution.context.system", "body": "<h1>Source code for dagster.core.execution.context.system</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">This module contains the execution context objects that are internal to the system.</span>\n<span class=\"sd\">Not every property on these should be exposed to random Jane or Joe dagster user</span>\n<span class=\"sd\">so we have a different layer of objects that encode the explicit public API</span>\n<span class=\"sd\">in the user_context module</span>\n<span class=\"sd\">&quot;&quot;&quot;</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">collections</span> <span class=\"kn\">import</span> <span class=\"n\">namedtuple</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dagster</span> <span class=\"kn\">import</span> <span class=\"n\">check</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.hook</span> <span class=\"kn\">import</span> <span class=\"n\">HookDefinition</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.mode</span> <span class=\"kn\">import</span> <span class=\"n\">ModeDefinition</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.pipeline_base</span> <span class=\"kn\">import</span> <span class=\"n\">IPipeline</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.resource</span> <span class=\"kn\">import</span> <span class=\"n\">ScopedResourcesBuilder</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.solid</span> <span class=\"kn\">import</span> <span class=\"n\">SolidDefinition</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.step_launcher</span> <span class=\"kn\">import</span> <span class=\"n\">StepLauncher</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.errors</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterInvariantViolationError</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">StepOutputHandle</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.retries</span> <span class=\"kn\">import</span> <span class=\"n\">Retries</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.executor.base</span> <span class=\"kn\">import</span> <span class=\"n\">Executor</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.log_manager</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterLogManager</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.storage.file_manager</span> <span class=\"kn\">import</span> <span class=\"n\">FileManager</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.storage.pipeline_run</span> <span class=\"kn\">import</span> <span class=\"n\">PipelineRun</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.system_config.objects</span> <span class=\"kn\">import</span> <span class=\"n\">EnvironmentConfig</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">SystemExecutionContextData</span><span class=\"p\">(</span>\n    <span class=\"n\">namedtuple</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;_SystemExecutionContextData&quot;</span><span class=\"p\">,</span>\n        <span class=\"p\">(</span>\n            <span class=\"s2\">&quot;pipeline_run scoped_resources_builder environment_config pipeline &quot;</span>\n            <span class=\"s2\">&quot;mode_def system_storage_def intermediate_storage_def instance intermediate_storage file_manager &quot;</span>\n            <span class=\"s2\">&quot;raise_on_error retries execution_plan&quot;</span>\n        <span class=\"p\">),</span>\n    <span class=\"p\">)</span>\n<span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;</span>\n<span class=\"sd\">    SystemExecutionContextData is the data that remains constant throughout the entire</span>\n<span class=\"sd\">    execution of a pipeline or plan.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span>\n        <span class=\"bp\">cls</span><span class=\"p\">,</span>\n        <span class=\"n\">pipeline_run</span><span class=\"p\">,</span>\n        <span class=\"n\">scoped_resources_builder</span><span class=\"p\">,</span>\n        <span class=\"n\">environment_config</span><span class=\"p\">,</span>\n        <span class=\"n\">pipeline</span><span class=\"p\">,</span>\n        <span class=\"n\">mode_def</span><span class=\"p\">,</span>\n        <span class=\"n\">system_storage_def</span><span class=\"p\">,</span>\n        <span class=\"n\">intermediate_storage_def</span><span class=\"p\">,</span>\n        <span class=\"n\">instance</span><span class=\"p\">,</span>\n        <span class=\"n\">intermediate_storage</span><span class=\"p\">,</span>\n        <span class=\"n\">file_manager</span><span class=\"p\">,</span>\n        <span class=\"n\">raise_on_error</span><span class=\"p\">,</span>\n        <span class=\"n\">retries</span><span class=\"p\">,</span>\n        <span class=\"n\">execution_plan</span><span class=\"p\">,</span>\n    <span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.system_storage</span> <span class=\"kn\">import</span> <span class=\"n\">SystemStorageDefinition</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.definitions.intermediate_storage</span> <span class=\"kn\">import</span> <span class=\"n\">IntermediateStorageDefinition</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.storage.intermediate_storage</span> <span class=\"kn\">import</span> <span class=\"n\">IntermediateStorage</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.instance</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterInstance</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.plan</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionPlan</span>\n\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">SystemExecutionContextData</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_run</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">pipeline_run</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pipeline_run&quot;</span><span class=\"p\">,</span> <span class=\"n\">PipelineRun</span><span class=\"p\">),</span>\n            <span class=\"n\">scoped_resources_builder</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n                <span class=\"n\">scoped_resources_builder</span><span class=\"p\">,</span> <span class=\"s2\">&quot;scoped_resources_builder&quot;</span><span class=\"p\">,</span> <span class=\"n\">ScopedResourcesBuilder</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">environment_config</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n                <span class=\"n\">environment_config</span><span class=\"p\">,</span> <span class=\"s2\">&quot;environment_config&quot;</span><span class=\"p\">,</span> <span class=\"n\">EnvironmentConfig</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">pipeline</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">pipeline</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pipeline&quot;</span><span class=\"p\">,</span> <span class=\"n\">IPipeline</span><span class=\"p\">),</span>\n            <span class=\"n\">mode_def</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">mode_def</span><span class=\"p\">,</span> <span class=\"s2\">&quot;mode_def&quot;</span><span class=\"p\">,</span> <span class=\"n\">ModeDefinition</span><span class=\"p\">),</span>\n            <span class=\"n\">system_storage_def</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n                <span class=\"n\">system_storage_def</span><span class=\"p\">,</span> <span class=\"s2\">&quot;system_storage_def&quot;</span><span class=\"p\">,</span> <span class=\"n\">SystemStorageDefinition</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">intermediate_storage_def</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_inst_param</span><span class=\"p\">(</span>\n                <span class=\"n\">intermediate_storage_def</span><span class=\"p\">,</span> <span class=\"s2\">&quot;intermediate_storage_def&quot;</span><span class=\"p\">,</span> <span class=\"n\">IntermediateStorageDefinition</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">instance</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">instance</span><span class=\"p\">,</span> <span class=\"s2\">&quot;instance&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterInstance</span><span class=\"p\">),</span>\n            <span class=\"n\">intermediate_storage</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n                <span class=\"n\">intermediate_storage</span><span class=\"p\">,</span> <span class=\"s2\">&quot;intermediate_storage&quot;</span><span class=\"p\">,</span> <span class=\"n\">IntermediateStorage</span>\n            <span class=\"p\">),</span>\n            <span class=\"n\">file_manager</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">file_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;file_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">FileManager</span><span class=\"p\">),</span>\n            <span class=\"n\">raise_on_error</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">bool_param</span><span class=\"p\">(</span><span class=\"n\">raise_on_error</span><span class=\"p\">,</span> <span class=\"s2\">&quot;raise_on_error&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">retries</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">retries</span><span class=\"p\">,</span> <span class=\"s2\">&quot;retries&quot;</span><span class=\"p\">,</span> <span class=\"n\">Retries</span><span class=\"p\">),</span>\n            <span class=\"n\">execution_plan</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_plan&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionPlan</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">run_id</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span><span class=\"o\">.</span><span class=\"n\">run_id</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">run_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">environment_config</span><span class=\"o\">.</span><span class=\"n\">original_config_dict</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline</span><span class=\"o\">.</span><span class=\"n\">get_definition</span><span class=\"p\">()</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">SystemExecutionContext</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"vm\">__slots__</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;_execution_context_data&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;_log_manager&quot;</span><span class=\"p\">]</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span>\n            <span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"s2\">&quot;execution_context_data&quot;</span><span class=\"p\">,</span> <span class=\"n\">SystemExecutionContextData</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"s2\">&quot;log_manager&quot;</span><span class=\"p\">,</span> <span class=\"n\">DagsterLogManager</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_run</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">scoped_resources_builder</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">scoped_resources_builder</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">run_id</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">run_id</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">run_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">run_config</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">environment_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">environment_config</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">pipeline</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">pipeline_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">mode_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">mode_def</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">system_storage_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">system_storage_def</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">intermediate_storage_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">intermediate_storage_def</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">instance</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">instance</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">intermediate_storage</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">intermediate_storage</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">file_manager</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">file_manager</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">raise_on_error</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">raise_on_error</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">retries</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">retries</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">log</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">logging_tags</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">execution_plan</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">execution_plan</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">has_tag</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"s2\">&quot;key&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">key</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">get_tag</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">key</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">,</span> <span class=\"s2\">&quot;key&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"n\">key</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">for_step</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">step</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionStep</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionStep</span><span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">SystemStepExecutionContext</span><span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span><span class=\"o\">.</span><span class=\"n\">with_tags</span><span class=\"p\">(</span><span class=\"o\">**</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">logging_tags</span><span class=\"p\">),</span> <span class=\"n\">step</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">for_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">TypeCheckContext</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">,</span> <span class=\"n\">dagster_type</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">SystemPipelineExecutionContext</span><span class=\"p\">(</span><span class=\"n\">SystemExecutionContext</span><span class=\"p\">):</span>\n    <span class=\"vm\">__slots__</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;_executor&quot;</span><span class=\"p\">]</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">executor</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">SystemPipelineExecutionContext</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_executor</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">executor</span><span class=\"p\">,</span> <span class=\"s2\">&quot;executor&quot;</span><span class=\"p\">,</span> <span class=\"n\">Executor</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">executor</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_executor</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">SystemStepExecutionContext</span><span class=\"p\">(</span><span class=\"n\">SystemExecutionContext</span><span class=\"p\">):</span>\n    <span class=\"vm\">__slots__</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;_step&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;_resources&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;_required_resource_keys&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;_step_launcher&quot;</span><span class=\"p\">]</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">step</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionStep</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.resources_init</span> <span class=\"kn\">import</span> <span class=\"n\">get_required_resource_keys_for_step</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionStep</span><span class=\"p\">)</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">SystemStepExecutionContext</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span> <span class=\"o\">=</span> <span class=\"n\">get_required_resource_keys_for_step</span><span class=\"p\">(</span>\n            <span class=\"n\">step</span><span class=\"p\">,</span>\n            <span class=\"n\">execution_context_data</span><span class=\"o\">.</span><span class=\"n\">execution_plan</span><span class=\"p\">,</span>\n            <span class=\"n\">execution_context_data</span><span class=\"o\">.</span><span class=\"n\">system_storage_def</span><span class=\"p\">,</span>\n            <span class=\"n\">execution_context_data</span><span class=\"o\">.</span><span class=\"n\">intermediate_storage_def</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">scoped_resources_builder</span><span class=\"o\">.</span><span class=\"n\">build</span><span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span>\n        <span class=\"p\">)</span>\n        <span class=\"n\">step_launcher_resources</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n            <span class=\"n\">resource</span> <span class=\"k\">for</span> <span class=\"n\">resource</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span> <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">resource</span><span class=\"p\">,</span> <span class=\"n\">StepLauncher</span><span class=\"p\">)</span>\n        <span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">step_launcher_resources</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">DagsterInvariantViolationError</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;Multiple required resources for solid </span><span class=\"si\">{solid_name}</span><span class=\"s2\"> have inherit StepLauncher&quot;</span>\n                <span class=\"s2\">&quot;There should be at most one step launcher resource per solid.&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                    <span class=\"n\">solid_name</span><span class=\"o\">=</span><span class=\"n\">step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"o\">.</span><span class=\"n\">name</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">step_launcher_resources</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step_launcher</span> <span class=\"o\">=</span> <span class=\"n\">step_launcher_resources</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step_launcher</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span> <span class=\"o\">=</span> <span class=\"n\">log_manager</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">for_compute</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">SystemComputeExecutionContext</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step_launcher</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step_launcher</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid_handle</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">solid</span><span class=\"o\">.</span><span class=\"n\">definition</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">get_solid</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resources</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">required_resource_keys</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">log</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">for_hook</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">hook_def</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">HookContext</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">,</span> <span class=\"n\">hook_def</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">step</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">for_asset_store</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">step_output_handle</span><span class=\"p\">,</span> <span class=\"n\">asset_store_handle</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.storage.asset_store</span> <span class=\"kn\">import</span> <span class=\"n\">AssetStoreHandle</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step_output_handle</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_output_handle&quot;</span><span class=\"p\">,</span> <span class=\"n\">StepOutputHandle</span><span class=\"p\">)</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">asset_store_handle</span><span class=\"p\">,</span> <span class=\"s2\">&quot;asset_store_handle&quot;</span><span class=\"p\">,</span> <span class=\"n\">AssetStoreHandle</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># determine if the step is skipped</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span>\n            <span class=\"c1\"># this is re-execution</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span><span class=\"o\">.</span><span class=\"n\">parent_run_id</span>\n            <span class=\"c1\"># only part of the pipeline is being re-executed</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span><span class=\"o\">.</span><span class=\"n\">step_keys_to_execute</span>\n            <span class=\"c1\"># this step is not being executed</span>\n            <span class=\"ow\">and</span> <span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">step_key</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span><span class=\"o\">.</span><span class=\"n\">step_keys_to_execute</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">source_run_id</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span><span class=\"o\">.</span><span class=\"n\">parent_run_id</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">source_run_id</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_run</span><span class=\"o\">.</span><span class=\"n\">run_id</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">AssetStoreContext</span><span class=\"p\">(</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">step_key</span><span class=\"p\">,</span>\n            <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"n\">step_output_handle</span><span class=\"o\">.</span><span class=\"n\">output_name</span><span class=\"p\">,</span>\n            <span class=\"n\">asset_metadata</span><span class=\"o\">=</span><span class=\"n\">asset_store_handle</span><span class=\"o\">.</span><span class=\"n\">asset_metadata</span><span class=\"p\">,</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"n\">solid_def</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">solid_def</span><span class=\"p\">,</span>\n            <span class=\"n\">source_run_id</span><span class=\"o\">=</span><span class=\"n\">source_run_id</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">get_asset_store</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">asset_store_key</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.storage.asset_store</span> <span class=\"kn\">import</span> <span class=\"n\">AssetStore</span>\n\n        <span class=\"c1\"># get AssetStore from resources using asset_store_key</span>\n        <span class=\"n\">asset_store</span> <span class=\"o\">=</span> <span class=\"nb\">getattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">resources</span><span class=\"p\">,</span> <span class=\"n\">asset_store_key</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst</span><span class=\"p\">(</span><span class=\"n\">asset_store</span><span class=\"p\">,</span> <span class=\"n\">AssetStore</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">using_asset_store</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">step_output_handle</span><span class=\"p\">):</span>\n        <span class=\"c1\"># pylint: disable=comparison-with-callable</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.storage.asset_store</span> <span class=\"kn\">import</span> <span class=\"n\">mem_asset_store</span>\n\n        <span class=\"n\">asset_store_key</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">execution_plan</span><span class=\"o\">.</span><span class=\"n\">get_asset_store_key</span><span class=\"p\">(</span><span class=\"n\">step_output_handle</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">mode_def</span><span class=\"o\">.</span><span class=\"n\">resource_defs</span><span class=\"p\">[</span><span class=\"n\">asset_store_key</span><span class=\"p\">]</span> <span class=\"o\">!=</span> <span class=\"n\">mem_asset_store</span>\n\n\n<div class=\"viewcode-block\" id=\"SystemComputeExecutionContext\"><a class=\"viewcode-back\" href=\"../../../../../../sections/api/apidocs/execution/#dagster.SystemComputeExecutionContext\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">SystemComputeExecutionContext</span><span class=\"p\">(</span><span class=\"n\">SystemStepExecutionContext</span><span class=\"p\">):</span>\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">solid_config</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">environment_config</span><span class=\"o\">.</span><span class=\"n\">solids</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">))</span>\n        <span class=\"k\">return</span> <span class=\"n\">solid_config</span><span class=\"o\">.</span><span class=\"n\">config</span> <span class=\"k\">if</span> <span class=\"n\">solid_config</span> <span class=\"k\">else</span> <span class=\"kc\">None</span></div>\n\n\n<div class=\"viewcode-block\" id=\"TypeCheckContext\"><a class=\"viewcode-back\" href=\"../../../../../../sections/api/apidocs/execution/#dagster.TypeCheckContext\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">TypeCheckContext</span><span class=\"p\">(</span><span class=\"n\">SystemExecutionContext</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;The ``context`` object available to a type check function on a DagsterType.</span>\n\n<span class=\"sd\">    Attributes:</span>\n<span class=\"sd\">        log (DagsterLogManager): Centralized log dispatch from user code.</span>\n<span class=\"sd\">        resources (Any): An object whose attributes contain the resources available to this solid.</span>\n<span class=\"sd\">        run_id (str): The id of this pipeline run.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">TypeCheckContext</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">scoped_resources_builder</span><span class=\"o\">.</span><span class=\"n\">build</span><span class=\"p\">(</span>\n            <span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">required_resource_keys</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span> <span class=\"o\">=</span> <span class=\"n\">log_manager</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resources</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span></div>\n\n\n<div class=\"viewcode-block\" id=\"HookContext\"><a class=\"viewcode-back\" href=\"../../../../../../sections/api/apidocs/execution/#dagster.HookContext\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">HookContext</span><span class=\"p\">(</span><span class=\"n\">SystemExecutionContext</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;The ``context`` object available to a hook function on an DagsterEvent.</span>\n\n<span class=\"sd\">    Attributes:</span>\n<span class=\"sd\">        log (DagsterLogManager): Centralized log dispatch from user code.</span>\n<span class=\"sd\">        hook_def (HookDefinition): The hook that the context object belongs to.</span>\n<span class=\"sd\">        step (ExecutionStep): The compute step associated with the hook.</span>\n<span class=\"sd\">        solid (Solid): The solid instance associated with the hook.</span>\n<span class=\"sd\">        resources (Any): Resources available in the hook context.</span>\n<span class=\"sd\">        solid_config (Dict[str, Any]): The parsed config specific to this solid.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">,</span> <span class=\"n\">hook_def</span><span class=\"p\">,</span> <span class=\"n\">step</span><span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.execution.plan.objects</span> <span class=\"kn\">import</span> <span class=\"n\">ExecutionStep</span>\n\n        <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">HookContext</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span><span class=\"n\">execution_context_data</span><span class=\"p\">,</span> <span class=\"n\">log_manager</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_log_manager</span> <span class=\"o\">=</span> <span class=\"n\">log_manager</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_hook_def</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">hook_def</span><span class=\"p\">,</span> <span class=\"s2\">&quot;hook_def&quot;</span><span class=\"p\">,</span> <span class=\"n\">HookDefinition</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step&quot;</span><span class=\"p\">,</span> <span class=\"n\">ExecutionStep</span><span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span> <span class=\"o\">=</span> <span class=\"n\">hook_def</span><span class=\"o\">.</span><span class=\"n\">required_resource_keys</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_execution_context_data</span><span class=\"o\">.</span><span class=\"n\">scoped_resources_builder</span><span class=\"o\">.</span><span class=\"n\">build</span><span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">hook_def</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_hook_def</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">step</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">pipeline_def</span><span class=\"o\">.</span><span class=\"n\">get_solid</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">resources</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resources</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">required_resource_keys</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_required_resource_keys</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">solid_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">solid_config</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">environment_config</span><span class=\"o\">.</span><span class=\"n\">solids</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_step</span><span class=\"o\">.</span><span class=\"n\">solid_handle</span><span class=\"p\">))</span>\n        <span class=\"k\">return</span> <span class=\"n\">solid_config</span><span class=\"o\">.</span><span class=\"n\">config</span> <span class=\"k\">if</span> <span class=\"n\">solid_config</span> <span class=\"k\">else</span> <span class=\"kc\">None</span></div>\n\n\n<div class=\"viewcode-block\" id=\"AssetStoreContext\"><a class=\"viewcode-back\" href=\"../../../../../../sections/api/apidocs/execution/#dagster.AssetStoreContext\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">AssetStoreContext</span><span class=\"p\">(</span>\n    <span class=\"n\">namedtuple</span><span class=\"p\">(</span>\n        <span class=\"s2\">&quot;_AssetStoreContext&quot;</span><span class=\"p\">,</span>\n        <span class=\"s2\">&quot;step_key output_name asset_metadata pipeline_name solid_def source_run_id&quot;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n<span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;The ``context`` object available to :py:class:`AssetStore`.</span>\n\n<span class=\"sd\">    Attributes:</span>\n<span class=\"sd\">        step_key (str): The step_key for the compute step.</span>\n<span class=\"sd\">        output_name (str): The name of the output. (default: &#39;result&#39;).</span>\n<span class=\"sd\">        asset_metadata ([Dict[str, Any]]): A dict of the metadata that is used for the asset store</span>\n<span class=\"sd\">            to store or retrieve the data object.</span>\n<span class=\"sd\">        pipeline_name (str): The name of the pipeline.</span>\n<span class=\"sd\">        solid_def (SolidDefinition): The definition of the solid that uses the asset store.</span>\n<span class=\"sd\">        source_run_id (Optional[str]): The id of the run which generates the output.</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__new__</span><span class=\"p\">(</span>\n        <span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">step_key</span><span class=\"p\">,</span> <span class=\"n\">output_name</span><span class=\"p\">,</span> <span class=\"n\">asset_metadata</span><span class=\"p\">,</span> <span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"n\">solid_def</span><span class=\"p\">,</span> <span class=\"n\">source_run_id</span><span class=\"o\">=</span><span class=\"kc\">None</span>\n    <span class=\"p\">):</span>\n\n        <span class=\"k\">return</span> <span class=\"nb\">super</span><span class=\"p\">(</span><span class=\"n\">AssetStoreContext</span><span class=\"p\">,</span> <span class=\"bp\">cls</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"fm\">__new__</span><span class=\"p\">(</span>\n            <span class=\"bp\">cls</span><span class=\"p\">,</span>\n            <span class=\"n\">step_key</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">step_key</span><span class=\"p\">,</span> <span class=\"s2\">&quot;step_key&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">output_name</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">output_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;output_name&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">asset_metadata</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_dict_param</span><span class=\"p\">(</span><span class=\"n\">asset_metadata</span><span class=\"p\">,</span> <span class=\"s2\">&quot;asset_metadata&quot;</span><span class=\"p\">,</span> <span class=\"n\">key_type</span><span class=\"o\">=</span><span class=\"nb\">str</span><span class=\"p\">),</span>\n            <span class=\"n\">pipeline_name</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">str_param</span><span class=\"p\">(</span><span class=\"n\">pipeline_name</span><span class=\"p\">,</span> <span class=\"s2\">&quot;pipeline_name&quot;</span><span class=\"p\">),</span>\n            <span class=\"n\">solid_def</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst_param</span><span class=\"p\">(</span><span class=\"n\">solid_def</span><span class=\"p\">,</span> <span class=\"s2\">&quot;solid_def&quot;</span><span class=\"p\">,</span> <span class=\"n\">SolidDefinition</span><span class=\"p\">),</span>\n            <span class=\"n\">source_run_id</span><span class=\"o\">=</span><span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">source_run_id</span><span class=\"p\">,</span> <span class=\"s2\">&quot;source_run_id&quot;</span><span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n<div class=\"viewcode-block\" id=\"AssetStoreContext.get_run_scoped_output_identifier\"><a class=\"viewcode-back\" href=\"../../../../../../sections/api/apidocs/execution/#dagster.AssetStoreContext.get_run_scoped_output_identifier\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">get_run_scoped_output_identifier</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;Utility method to get a collection of identifiers that as a whole represent a unique</span>\n<span class=\"sd\">        step output.</span>\n\n<span class=\"sd\">        The unique identifier collection consists of</span>\n\n<span class=\"sd\">        - ``source_run_id``: the id of the run which generates the output.</span>\n<span class=\"sd\">            Note: This method also handles the re-execution memoization logic. If the step that</span>\n<span class=\"sd\">            generates the output is skipped in the re-execution, the ``run_id`` will be the id</span>\n<span class=\"sd\">            of its parent run.</span>\n<span class=\"sd\">        - ``step_key``: the key for a compute step.</span>\n<span class=\"sd\">        - ``output_name``: the name of the output. (default: &#39;result&#39;).</span>\n\n<span class=\"sd\">        Returns:</span>\n<span class=\"sd\">            List[str, ...]: A list of identifiers, i.e. run id, step key, and output name</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">return</span> <span class=\"p\">[</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">source_run_id</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">step_key</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">output_name</span><span class=\"p\">]</span></div></div>\n</pre></div>", "current_page_name": "_modules/dagster/core/execution/context/system", "sidebars": ["globaltoc.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}