{"parents": [{"link": "../../../", "title": "Module code"}], "title": "dagster.config.field", "body": "<h1>Source code for dagster.config.field</h1><div class=\"highlight\"><pre>\n<span></span><span class=\"kn\">from</span> <span class=\"nn\">dagster</span> <span class=\"kn\">import</span> <span class=\"n\">check</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.builtins</span> <span class=\"kn\">import</span> <span class=\"n\">BuiltinEnum</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.core.errors</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterInvalidConfigError</span><span class=\"p\">,</span> <span class=\"n\">DagsterInvalidDefinitionError</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.serdes</span> <span class=\"kn\">import</span> <span class=\"n\">serialize_value</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils</span> <span class=\"kn\">import</span> <span class=\"n\">is_enum_value</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dagster.utils.typing_api</span> <span class=\"kn\">import</span> <span class=\"n\">is_typing_type</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">.config_type</span> <span class=\"kn\">import</span> <span class=\"n\">Array</span><span class=\"p\">,</span> <span class=\"n\">ConfigAnyInstance</span><span class=\"p\">,</span> <span class=\"n\">ConfigType</span><span class=\"p\">,</span> <span class=\"n\">ConfigTypeKind</span>\n<span class=\"kn\">from</span> <span class=\"nn\">.field_utils</span> <span class=\"kn\">import</span> <span class=\"n\">FIELD_NO_DEFAULT_PROVIDED</span><span class=\"p\">,</span> <span class=\"n\">all_optional_type</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">_is_config_type_class</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"p\">)</span> <span class=\"ow\">and</span> <span class=\"nb\">issubclass</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"n\">ConfigType</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">helpful_list_error_string</span><span class=\"p\">():</span>\n    <span class=\"k\">return</span> <span class=\"s2\">&quot;Please use a python list (e.g. [int]) or dagster.Array (e.g. Array(int)) instead.&quot;</span>\n\n\n<span class=\"n\">VALID_CONFIG_DESC</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;&quot;</span>\n<span class=\"s2\">1. A Python primitive type that resolve to dagster config</span>\n<span class=\"s2\">   types: int, float, bool, str.</span>\n\n<span class=\"s2\">2. A dagster config type: Int, Float, Bool, String, StringSource, Path, Any,</span>\n<span class=\"s2\">   Array, Noneable, Selector, Shape, Permissive, etc.</span>\n\n<span class=\"s2\">3. A bare python dictionary, which is wrapped in Shape. Any</span>\n<span class=\"s2\">   values in the dictionary get resolved by the same rules, recursively.</span>\n\n<span class=\"s2\">4. A bare python list of length one which itself is config type.</span>\n<span class=\"s2\">   Becomes Array with list element as an argument.</span>\n<span class=\"s2\">&quot;&quot;&quot;</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">.field_utils</span> <span class=\"kn\">import</span> <span class=\"n\">convert_fields_to_dict_type</span>\n\n    <span class=\"c1\"># Short circuit if it&#39;s already a Config Type</span>\n    <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">ConfigType</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">dagster_type</span>\n\n    <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"nb\">dict</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">convert_fields_to_dict_type</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"nb\">list</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">)</span> <span class=\"o\">!=</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span><span class=\"s2\">&quot;Array specifications must only be of length 1&quot;</span><span class=\"p\">)</span>\n\n        <span class=\"n\">inner_type</span> <span class=\"o\">=</span> <span class=\"n\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">inner_type</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n                <span class=\"s2\">&quot;Invalid member of array specification: </span><span class=\"si\">{value}</span><span class=\"s2\"> in list </span><span class=\"si\">{the_list}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                    <span class=\"n\">value</span><span class=\"o\">=</span><span class=\"nb\">repr</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]),</span> <span class=\"n\">the_list</span><span class=\"o\">=</span><span class=\"n\">dagster_type</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">Array</span><span class=\"p\">(</span><span class=\"n\">inner_type</span><span class=\"p\">)</span>\n\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.types.dagster_type</span> <span class=\"kn\">import</span> <span class=\"n\">DagsterType</span><span class=\"p\">,</span> <span class=\"n\">List</span><span class=\"p\">,</span> <span class=\"n\">ListType</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.types.python_set</span> <span class=\"kn\">import</span> <span class=\"n\">Set</span><span class=\"p\">,</span> <span class=\"n\">_TypedPythonSet</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.core.types.python_tuple</span> <span class=\"kn\">import</span> <span class=\"n\">Tuple</span><span class=\"p\">,</span> <span class=\"n\">_TypedPythonTuple</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">_is_config_type_class</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">param_invariant</span><span class=\"p\">(</span>\n            <span class=\"kc\">False</span><span class=\"p\">,</span>\n            <span class=\"s2\">&quot;dagster_type&quot;</span><span class=\"p\">,</span>\n            <span class=\"s2\">&quot;Cannot pass a config type class to resolve_to_config_type. Got </span><span class=\"si\">{dagster_type}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">dagster_type</span><span class=\"o\">=</span><span class=\"n\">dagster_type</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"p\">)</span> <span class=\"ow\">and</span> <span class=\"nb\">issubclass</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">DagsterType</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;You have passed a DagsterType class </span><span class=\"si\">{dagster_type}</span><span class=\"s2\"> to the config system. &quot;</span>\n            <span class=\"s2\">&quot;The DagsterType and config schema systems are separate. &quot;</span>\n            <span class=\"s2\">&quot;Valid config values are:</span><span class=\"se\">\\n</span><span class=\"si\">{desc}</span><span class=\"s2\">&quot;</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">dagster_type</span><span class=\"o\">=</span><span class=\"nb\">repr</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">),</span> <span class=\"n\">desc</span><span class=\"o\">=</span><span class=\"n\">VALID_CONFIG_DESC</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">is_typing_type</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n            <span class=\"p\">(</span>\n                <span class=\"s2\">&quot;You have passed in </span><span class=\"si\">{dagster_type}</span><span class=\"s2\"> to the config system. Types from &quot;</span>\n                <span class=\"s2\">&quot;the typing module in python are not allowed in the config system. &quot;</span>\n                <span class=\"s2\">&quot;You must use types that are imported from dagster or primitive types &quot;</span>\n                <span class=\"s2\">&quot;such as bool, int, etc.&quot;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"o\">=</span><span class=\"n\">dagster_type</span><span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">dagster_type</span> <span class=\"ow\">is</span> <span class=\"n\">List</span> <span class=\"ow\">or</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">ListType</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;Cannot use List in the context of config. &quot;</span> <span class=\"o\">+</span> <span class=\"n\">helpful_list_error_string</span><span class=\"p\">()</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">dagster_type</span> <span class=\"ow\">is</span> <span class=\"n\">Set</span> <span class=\"ow\">or</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">_TypedPythonSet</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;Cannot use Set in the context of a config field. &quot;</span> <span class=\"o\">+</span> <span class=\"n\">helpful_list_error_string</span><span class=\"p\">()</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">dagster_type</span> <span class=\"ow\">is</span> <span class=\"n\">Tuple</span> <span class=\"ow\">or</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">_TypedPythonTuple</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n            <span class=\"s2\">&quot;Cannot use Tuple in the context of a config field. &quot;</span> <span class=\"o\">+</span> <span class=\"n\">helpful_list_error_string</span><span class=\"p\">()</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">,</span> <span class=\"n\">DagsterType</span><span class=\"p\">):</span>\n        <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n            <span class=\"p\">(</span>\n                <span class=\"s2\">&quot;You have passed an instance of DagsterType </span><span class=\"si\">{type_name}</span><span class=\"s2\"> to the config &quot;</span>\n                <span class=\"s2\">&quot;system (Repr of type: </span><span class=\"si\">{dagster_type}</span><span class=\"s2\">). &quot;</span>\n                <span class=\"s2\">&quot;The DagsterType and config schema systems are separate. &quot;</span>\n                <span class=\"s2\">&quot;Valid config values are:</span><span class=\"se\">\\n</span><span class=\"si\">{desc}</span><span class=\"s2\">&quot;</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                <span class=\"n\">type_name</span><span class=\"o\">=</span><span class=\"n\">dagster_type</span><span class=\"o\">.</span><span class=\"n\">display_name</span><span class=\"p\">,</span>\n                <span class=\"n\">dagster_type</span><span class=\"o\">=</span><span class=\"nb\">repr</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">),</span>\n                <span class=\"n\">desc</span><span class=\"o\">=</span><span class=\"n\">VALID_CONFIG_DESC</span><span class=\"p\">,</span>\n            <span class=\"p\">),</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"c1\"># If we are passed here either:</span>\n    <span class=\"c1\">#  1) We have been passed a python builtin</span>\n    <span class=\"c1\">#  2) We have been a dagster wrapping type that needs to be convert its config variant</span>\n    <span class=\"c1\">#     e.g. dagster.List</span>\n    <span class=\"c1\">#  2) We have been passed an invalid thing. We return False to signify this. It is</span>\n    <span class=\"c1\">#     up to callers to report a reasonable error.</span>\n\n    <span class=\"kn\">from</span> <span class=\"nn\">dagster.primitive_mapping</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n        <span class=\"n\">remap_python_builtin_for_config</span><span class=\"p\">,</span>\n        <span class=\"n\">is_supported_config_python_builtin</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">is_supported_config_python_builtin</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">remap_python_builtin_for_config</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">)</span>\n\n    <span class=\"k\">if</span> <span class=\"n\">dagster_type</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n        <span class=\"k\">return</span> <span class=\"n\">ConfigAnyInstance</span>\n    <span class=\"k\">if</span> <span class=\"n\">BuiltinEnum</span><span class=\"o\">.</span><span class=\"n\">contains</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"n\">ConfigType</span><span class=\"o\">.</span><span class=\"n\">from_builtin_enum</span><span class=\"p\">(</span><span class=\"n\">dagster_type</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># This means that this is an error and we are return False to a callsite</span>\n    <span class=\"c1\"># We do the error reporting there because those callsites have more context</span>\n    <span class=\"k\">return</span> <span class=\"kc\">False</span>\n\n\n<div class=\"viewcode-block\" id=\"Field\"><a class=\"viewcode-back\" href=\"../../../../sections/api/apidocs/config/#dagster.Field\">[docs]</a><span class=\"k\">class</span> <span class=\"nc\">Field</span><span class=\"p\">(</span><span class=\"nb\">object</span><span class=\"p\">):</span>\n    <span class=\"sd\">&quot;&quot;&quot;Defines the schema for a configuration field.</span>\n\n<span class=\"sd\">    Fields are used in config schema instead of bare types when one wants to add a description,</span>\n<span class=\"sd\">    a default value, or to mark it as not required.</span>\n\n<span class=\"sd\">    Config fields are parsed according to their schemas in order to yield values available at</span>\n<span class=\"sd\">    pipeline execution time through the config system. Config fields can be set on solids, on</span>\n<span class=\"sd\">    loaders and materializers for custom, and on other pluggable components of the system, such as</span>\n<span class=\"sd\">    resources, loggers, and executors.</span>\n\n\n<span class=\"sd\">    Args:</span>\n<span class=\"sd\">        config (Any): The schema for the config. This value can be any of:</span>\n\n<span class=\"sd\">            1. A Python primitive type that resolves to a Dagster config type</span>\n<span class=\"sd\">               (:py:class:`~python:int`, :py:class:`~python:float`, :py:class:`~python:bool`,</span>\n<span class=\"sd\">               :py:class:`~python:str`, or :py:class:`~python:list`).</span>\n\n<span class=\"sd\">            2. A Dagster config type:</span>\n\n<span class=\"sd\">               * :py:data:`~dagster.Any`</span>\n<span class=\"sd\">               * :py:class:`~dagster.Array`</span>\n<span class=\"sd\">               * :py:data:`~dagster.Bool`</span>\n<span class=\"sd\">               * :py:data:`~dagster.Enum`</span>\n<span class=\"sd\">               * :py:data:`~dagster.Float`</span>\n<span class=\"sd\">               * :py:data:`~dagster.Int`</span>\n<span class=\"sd\">               * :py:data:`~dagster.IntSource`</span>\n<span class=\"sd\">               * :py:data:`~dagster.Noneable`</span>\n<span class=\"sd\">               * :py:class:`~dagster.Permissive`</span>\n<span class=\"sd\">               * :py:class:`~dagster.ScalarUnion`</span>\n<span class=\"sd\">               * :py:class:`~dagster.Selector`</span>\n<span class=\"sd\">               * :py:class:`~dagster.Shape`</span>\n<span class=\"sd\">               * :py:data:`~dagster.String`</span>\n<span class=\"sd\">               * :py:data:`~dagster.StringSource`</span>\n\n<span class=\"sd\">            3. A bare python dictionary, which will be automatically wrapped in</span>\n<span class=\"sd\">               :py:class:`~dagster.Shape`. Values of the dictionary are resolved recursively</span>\n<span class=\"sd\">               according to the same rules.</span>\n\n<span class=\"sd\">            4. A bare python list of length one which itself is config type.</span>\n<span class=\"sd\">               Becomes :py:class:`Array` with list element as an argument.</span>\n\n<span class=\"sd\">        default_value (Any):</span>\n<span class=\"sd\">            A default value for this field, conformant to the schema set by the ``dagster_type``</span>\n<span class=\"sd\">            argument. If a default value is provided, ``is_required`` should be ``False``.</span>\n\n<span class=\"sd\">            Note: for config types that do post processing such as Enum, this value must be</span>\n<span class=\"sd\">            the pre processed version, ie use ``ExampleEnum.VALUE.name`` instead of</span>\n<span class=\"sd\">            ``ExampleEnum.VALUE``</span>\n\n<span class=\"sd\">        is_required (bool):</span>\n<span class=\"sd\">            Whether the presence of this field is required. Defaults to true. If ``is_required``</span>\n<span class=\"sd\">            is ``True``, no default value should be provided.</span>\n\n<span class=\"sd\">        description (str):</span>\n<span class=\"sd\">            A human-readable description of this config field.</span>\n\n<span class=\"sd\">    Examples:</span>\n\n<span class=\"sd\">    .. code-block:: python</span>\n\n<span class=\"sd\">        @solid(</span>\n<span class=\"sd\">            config_schema={</span>\n<span class=\"sd\">                &#39;word&#39;: Field(str, description=&#39;I am a word.&#39;),</span>\n<span class=\"sd\">                &#39;repeats&#39;: Field(Int, default_value=1, is_required=False),</span>\n<span class=\"sd\">            }</span>\n<span class=\"sd\">        )</span>\n<span class=\"sd\">        def repeat_word(context):</span>\n<span class=\"sd\">            return context.solid_config[&#39;word&#39;] * context.solid_config[&#39;repeats&#39;]</span>\n<span class=\"sd\">    &quot;&quot;&quot;</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_resolve_config_arg</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"p\">,</span> <span class=\"n\">ConfigType</span><span class=\"p\">):</span>\n            <span class=\"k\">return</span> <span class=\"n\">config</span>\n\n        <span class=\"n\">config_type</span> <span class=\"o\">=</span> <span class=\"n\">resolve_to_config_type</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">config_type</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n                <span class=\"p\">(</span>\n                    <span class=\"s2\">&quot;Attempted to pass </span><span class=\"si\">{value_repr}</span><span class=\"s2\"> to a Field that expects a valid &quot;</span>\n                    <span class=\"s2\">&quot;dagster type usable in config (e.g. Dict, Int, String et al).&quot;</span>\n                <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span><span class=\"n\">value_repr</span><span class=\"o\">=</span><span class=\"nb\">repr</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"p\">))</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">config_type</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"p\">,</span> <span class=\"n\">default_value</span><span class=\"o\">=</span><span class=\"n\">FIELD_NO_DEFAULT_PROVIDED</span><span class=\"p\">,</span> <span class=\"n\">is_required</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"p\">):</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">.validate</span> <span class=\"kn\">import</span> <span class=\"n\">validate_config</span>\n        <span class=\"kn\">from</span> <span class=\"nn\">.post_process</span> <span class=\"kn\">import</span> <span class=\"n\">resolve_defaults</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">inst</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_resolve_config_arg</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"p\">),</span> <span class=\"n\">ConfigType</span><span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">description</span> <span class=\"o\">=</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_str_param</span><span class=\"p\">(</span><span class=\"n\">description</span><span class=\"p\">,</span> <span class=\"s2\">&quot;description&quot;</span><span class=\"p\">)</span>\n\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_bool_param</span><span class=\"p\">(</span><span class=\"n\">is_required</span><span class=\"p\">,</span> <span class=\"s2\">&quot;is_required&quot;</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">default_value</span> <span class=\"o\">!=</span> <span class=\"n\">FIELD_NO_DEFAULT_PROVIDED</span><span class=\"p\">:</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">param_invariant</span><span class=\"p\">(</span>\n                <span class=\"ow\">not</span> <span class=\"p\">(</span><span class=\"n\">callable</span><span class=\"p\">(</span><span class=\"n\">default_value</span><span class=\"p\">)),</span> <span class=\"s2\">&quot;default_value&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;default_value cannot be a callable&quot;</span>\n            <span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">is_required</span> <span class=\"ow\">is</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n            <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">param_invariant</span><span class=\"p\">(</span>\n                <span class=\"n\">default_value</span> <span class=\"o\">==</span> <span class=\"n\">FIELD_NO_DEFAULT_PROVIDED</span><span class=\"p\">,</span>\n                <span class=\"s2\">&quot;default_value&quot;</span><span class=\"p\">,</span>\n                <span class=\"s2\">&quot;required arguments should not specify default values&quot;</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span> <span class=\"o\">=</span> <span class=\"n\">default_value</span>\n\n        <span class=\"c1\"># check explicit default value</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">default_provided</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"o\">.</span><span class=\"n\">kind</span> <span class=\"o\">==</span> <span class=\"n\">ConfigTypeKind</span><span class=\"o\">.</span><span class=\"n\">ENUM</span> <span class=\"ow\">and</span> <span class=\"n\">is_enum_value</span><span class=\"p\">(</span><span class=\"n\">default_value</span><span class=\"p\">):</span>\n                <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidDefinitionError</span><span class=\"p\">(</span>\n                    <span class=\"p\">(</span>\n                        <span class=\"s2\">&quot;You have passed into a python enum value as the default value &quot;</span>\n                        <span class=\"s2\">&quot;into of a config enum type </span><span class=\"si\">{name}</span><span class=\"s2\">. You must pass in the underlying &quot;</span>\n                        <span class=\"s2\">&quot;string represention as the default value. One of </span><span class=\"si\">{value_set}</span><span class=\"s2\">.&quot;</span>\n                    <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n                        <span class=\"n\">value_set</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">ev</span><span class=\"o\">.</span><span class=\"n\">config_value</span> <span class=\"k\">for</span> <span class=\"n\">ev</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"o\">.</span><span class=\"n\">enum_values</span><span class=\"p\">],</span>\n                        <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"o\">.</span><span class=\"n\">given_name</span><span class=\"p\">,</span>\n                    <span class=\"p\">)</span>\n                <span class=\"p\">)</span>\n\n            <span class=\"n\">evr</span> <span class=\"o\">=</span> <span class=\"n\">validate_config</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"n\">default_value</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">evr</span><span class=\"o\">.</span><span class=\"n\">success</span><span class=\"p\">:</span>\n                <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidConfigError</span><span class=\"p\">(</span>\n                    <span class=\"s2\">&quot;Invalid default_value for Field.&quot;</span><span class=\"p\">,</span> <span class=\"n\">evr</span><span class=\"o\">.</span><span class=\"n\">errors</span><span class=\"p\">,</span> <span class=\"n\">default_value</span><span class=\"p\">,</span>\n                <span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">is_required</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">is_optional</span> <span class=\"o\">=</span> <span class=\"n\">all_optional_type</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"p\">)</span> <span class=\"ow\">or</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">default_provided</span>\n            <span class=\"n\">is_required</span> <span class=\"o\">=</span> <span class=\"ow\">not</span> <span class=\"n\">is_optional</span>\n\n            <span class=\"c1\"># on implicitly optional - set the default value</span>\n            <span class=\"c1\"># by resolving the defaults of the type</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">is_required</span> <span class=\"ow\">and</span> <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">default_provided</span><span class=\"p\">:</span>\n                <span class=\"n\">evr</span> <span class=\"o\">=</span> <span class=\"n\">resolve_defaults</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"p\">,</span> <span class=\"kc\">None</span><span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">evr</span><span class=\"o\">.</span><span class=\"n\">success</span><span class=\"p\">:</span>\n                    <span class=\"k\">raise</span> <span class=\"n\">DagsterInvalidConfigError</span><span class=\"p\">(</span>\n                        <span class=\"s2\">&quot;Unable to resolve implicit default_value for Field.&quot;</span><span class=\"p\">,</span> <span class=\"n\">evr</span><span class=\"o\">.</span><span class=\"n\">errors</span><span class=\"p\">,</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n                    <span class=\"p\">)</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span> <span class=\"o\">=</span> <span class=\"n\">evr</span><span class=\"o\">.</span><span class=\"n\">value</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_is_required</span> <span class=\"o\">=</span> <span class=\"n\">is_required</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">is_required</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_is_required</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">default_provided</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">&quot;&quot;&quot;Was a default value provided</span>\n\n<span class=\"sd\">        Returns:</span>\n<span class=\"sd\">            bool: Yes or no</span>\n<span class=\"sd\">        &quot;&quot;&quot;</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span> <span class=\"o\">!=</span> <span class=\"n\">FIELD_NO_DEFAULT_PROVIDED</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">default_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">invariant</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">default_provided</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Asking for default value when none was provided&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">default_value_as_json_str</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">invariant</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">default_provided</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Asking for default value when none was provided&quot;</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">serialize_value</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">default_value</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__repr__</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"s2\">&quot;Field(</span><span class=\"si\">{config_type}</span><span class=\"s2\">, default=</span><span class=\"si\">{default}</span><span class=\"s2\">, is_required=</span><span class=\"si\">{is_required}</span><span class=\"s2\">)&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">format</span><span class=\"p\">(</span>\n            <span class=\"n\">config_type</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">config_type</span><span class=\"p\">,</span>\n            <span class=\"n\">default</span><span class=\"o\">=</span><span class=\"s2\">&quot;@&quot;</span>\n            <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span> <span class=\"o\">==</span> <span class=\"n\">FIELD_NO_DEFAULT_PROVIDED</span>\n            <span class=\"k\">else</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_default_value</span><span class=\"p\">,</span>\n            <span class=\"n\">is_required</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">is_required</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span></div>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">check_opt_field_param</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"n\">param_name</span><span class=\"p\">):</span>\n    <span class=\"k\">return</span> <span class=\"n\">check</span><span class=\"o\">.</span><span class=\"n\">opt_inst_param</span><span class=\"p\">(</span><span class=\"n\">obj</span><span class=\"p\">,</span> <span class=\"n\">param_name</span><span class=\"p\">,</span> <span class=\"n\">Field</span><span class=\"p\">)</span>\n</pre></div>", "current_page_name": "_modules/dagster/config/field", "sidebars": ["globaltoc.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}