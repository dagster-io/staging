
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>dagster.core.types.dagster_type &#8212; Dagster</title>
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
 
<link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />


<meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
    <div class="documentwrapper">
        <div class="bodywrapper">
            <div class="related top">
                &nbsp;
<nav id="rellinks">
    <ul>
        <li>
            <a href="/" title="Home">Home</a>
        </li>
    </ul>
</nav>
            </div>
            

            

            <div class="body" role="main">
                
  <h1>Source code for dagster.core.types.dagster_type</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span> <span class="k">as</span> <span class="n">PythonEnum</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="kn">from</span> <span class="nn">dagster</span> <span class="kn">import</span> <span class="n">check</span>
<span class="kn">from</span> <span class="nn">dagster.builtins</span> <span class="kn">import</span> <span class="n">BuiltinEnum</span>
<span class="kn">from</span> <span class="nn">dagster.config.config_type</span> <span class="kn">import</span> <span class="n">Array</span>
<span class="kn">from</span> <span class="nn">dagster.config.config_type</span> <span class="kn">import</span> <span class="n">Noneable</span> <span class="k">as</span> <span class="n">ConfigNoneable</span>
<span class="kn">from</span> <span class="nn">dagster.core.definitions.events</span> <span class="kn">import</span> <span class="n">TypeCheck</span>
<span class="kn">from</span> <span class="nn">dagster.core.errors</span> <span class="kn">import</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">,</span> <span class="n">DagsterInvariantViolationError</span>
<span class="kn">from</span> <span class="nn">dagster.core.storage.type_storage</span> <span class="kn">import</span> <span class="n">TypeStoragePlugin</span>
<span class="kn">from</span> <span class="nn">dagster.serdes</span> <span class="kn">import</span> <span class="n">whitelist_for_serdes</span>

<span class="kn">from</span> <span class="nn">.builtin_config_schemas</span> <span class="kn">import</span> <span class="n">BuiltinSchemas</span>
<span class="kn">from</span> <span class="nn">.config_schema</span> <span class="kn">import</span> <span class="n">DagsterTypeLoader</span><span class="p">,</span> <span class="n">DagsterTypeMaterializer</span>
<span class="kn">from</span> <span class="nn">.marshal</span> <span class="kn">import</span> <span class="n">PickleSerializationStrategy</span><span class="p">,</span> <span class="n">SerializationStrategy</span>


<span class="nd">@whitelist_for_serdes</span>
<span class="k">class</span> <span class="nc">DagsterTypeKind</span><span class="p">(</span><span class="n">PythonEnum</span><span class="p">):</span>
    <span class="n">ANY</span> <span class="o">=</span> <span class="s2">&quot;ANY&quot;</span>
    <span class="n">SCALAR</span> <span class="o">=</span> <span class="s2">&quot;SCALAR&quot;</span>
    <span class="n">LIST</span> <span class="o">=</span> <span class="s2">&quot;LIST&quot;</span>
    <span class="n">NOTHING</span> <span class="o">=</span> <span class="s2">&quot;NOTHING&quot;</span>
    <span class="n">NULLABLE</span> <span class="o">=</span> <span class="s2">&quot;NULLABLE&quot;</span>
    <span class="n">REGULAR</span> <span class="o">=</span> <span class="s2">&quot;REGULAR&quot;</span>


<div class="viewcode-block" id="DagsterType"><a class="viewcode-back" href="../../../../sections/api/apidocs/types.html#dagster_pandas.DagsterType">[docs]</a><span class="k">class</span> <span class="nc">DagsterType</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Define a type in dagster. These can be used in the inputs and outputs of solids.</span>

<span class="sd">    Args:</span>
<span class="sd">        type_check_fn (Callable[[TypeCheckContext, Any], [Union[bool, TypeCheck]]]):</span>
<span class="sd">            The function that defines the type check. It takes the value flowing</span>
<span class="sd">            through the input or output of the solid. If it passes, return either</span>
<span class="sd">            ``True`` or a :py:class:`~dagster.TypeCheck` with ``success`` set to ``True``. If it fails,</span>
<span class="sd">            return either ``False`` or a :py:class:`~dagster.TypeCheck` with ``success`` set to ``False``.</span>
<span class="sd">            The first argument must be named ``context`` (or, if unused, ``_``, ``_context``, or ``context_``).</span>
<span class="sd">            Use ``required_resource_keys`` for access to resources.</span>
<span class="sd">        key (Optional[str]): The unique key to identify types programatically.</span>
<span class="sd">            The key property always has a value. If you omit key to the argument</span>
<span class="sd">            to the init function, it instead receives the value of ``name``. If</span>
<span class="sd">            neither ``key`` nor ``name`` is provided, a ``CheckError`` is thrown.</span>

<span class="sd">            In the case of a generic type such as ``List`` or ``Optional``, this is</span>
<span class="sd">            generated programatically based on the type parameters.</span>

<span class="sd">            For most use cases, name should be set and the key argument should</span>
<span class="sd">            not be specified.</span>
<span class="sd">        name (Optional[str]): A unique name given by a user. If ``key`` is ``None``, ``key``</span>
<span class="sd">            becomes this value. Name is not given in a case where the user does</span>
<span class="sd">            not specify a unique name for this type, such as a generic class.</span>
<span class="sd">        description (Optional[str]): A markdown-formatted string, displayed in tooling.</span>
<span class="sd">        loader (Optional[DagsterTypeLoader]): An instance of a class that</span>
<span class="sd">            inherits from :py:class:`~dagster.DagsterTypeLoader` and can map config data to a value of</span>
<span class="sd">            this type. Specify this argument if you will need to shim values of this type using the</span>
<span class="sd">            config machinery. As a rule, you should use the</span>
<span class="sd">            :py:func:`@dagster_type_loader &lt;dagster.dagster_type_loader&gt;` decorator to construct</span>
<span class="sd">            these arguments.</span>
<span class="sd">        materializer (Optional[DagsterTypeMaterializer]): An instance of a class</span>
<span class="sd">            that inherits from :py:class:`~dagster.DagsterTypeMaterializer` and can persist values of</span>
<span class="sd">            this type. As a rule, you should use the</span>
<span class="sd">            :py:func:`@dagster_type_materializer &lt;dagster.dagster_type_materializer&gt;`</span>
<span class="sd">            decorator to construct these arguments.</span>
<span class="sd">        serialization_strategy (Optional[SerializationStrategy]): An instance of a class that</span>
<span class="sd">            inherits from :py:class:`~dagster.SerializationStrategy`. The default strategy for serializing</span>
<span class="sd">            this value when automatically persisting it between execution steps. You should set</span>
<span class="sd">            this value if the ordinary serialization machinery (e.g., pickle) will not be adequate</span>
<span class="sd">            for this type.</span>
<span class="sd">        auto_plugins (Optional[List[Type[TypeStoragePlugin]]]): If types must be serialized differently</span>
<span class="sd">            depending on the storage being used for intermediates, they should specify this</span>
<span class="sd">            argument. In these cases the serialization_strategy argument is not sufficient because</span>
<span class="sd">            serialization requires specialized API calls, e.g. to call an S3 API directly instead</span>
<span class="sd">            of using a generic file object. See ``dagster_pyspark.DataFrame`` for an example.</span>
<span class="sd">        required_resource_keys (Optional[Set[str]]): Resource keys required by the ``type_check_fn``.</span>
<span class="sd">        is_builtin (bool): Defaults to False. This is used by tools to display or</span>
<span class="sd">            filter built-in types (such as :py:class:`~dagster.String`, :py:class:`~dagster.Int`) to visually distinguish</span>
<span class="sd">            them from user-defined types. Meant for internal use.</span>
<span class="sd">        kind (DagsterTypeKind): Defaults to None. This is used to determine the kind of runtime type</span>
<span class="sd">            for InputDefinition and OutputDefinition type checking.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">type_check_fn</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">is_builtin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">materializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">serialization_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">auto_plugins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">required_resource_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">REGULAR</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">)</span>
        <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>

        <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">),</span> <span class="s2">&quot;Must set key or name&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">check</span><span class="o">.</span><span class="n">param_invariant</span><span class="p">(</span>
                <span class="nb">bool</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;If name is not provided, must provide key.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">key</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">check</span><span class="o">.</span><span class="n">param_invariant</span><span class="p">(</span>
                <span class="nb">bool</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;If key is not provided, must provide name.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span> <span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span><span class="n">key</span> <span class="ow">and</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">key</span><span class="p">,</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loader</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_inst_param</span><span class="p">(</span><span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;loader&quot;</span><span class="p">,</span> <span class="n">DagsterTypeLoader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materializer</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_inst_param</span><span class="p">(</span>
            <span class="n">materializer</span><span class="p">,</span> <span class="s2">&quot;materializer&quot;</span><span class="p">,</span> <span class="n">DagsterTypeMaterializer</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">serialization_strategy</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_inst_param</span><span class="p">(</span>
            <span class="n">serialization_strategy</span><span class="p">,</span>
            <span class="s2">&quot;serialization_strategy&quot;</span><span class="p">,</span>
            <span class="n">SerializationStrategy</span><span class="p">,</span>
            <span class="n">PickleSerializationStrategy</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">required_resource_keys</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_set_param</span><span class="p">(</span>
            <span class="n">required_resource_keys</span><span class="p">,</span> <span class="s2">&quot;required_resource_keys&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_type_check_fn</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">callable_param</span><span class="p">(</span><span class="n">type_check_fn</span><span class="p">,</span> <span class="s2">&quot;type_check_fn&quot;</span><span class="p">)</span>
        <span class="n">_validate_type_check_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_check_fn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>

        <span class="n">auto_plugins</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_list_param</span><span class="p">(</span><span class="n">auto_plugins</span><span class="p">,</span> <span class="s2">&quot;auto_plugins&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span>

        <span class="n">check</span><span class="o">.</span><span class="n">param_invariant</span><span class="p">(</span>
            <span class="nb">all</span><span class="p">(</span>
                <span class="nb">issubclass</span><span class="p">(</span><span class="n">auto_plugin_type</span><span class="p">,</span> <span class="n">TypeStoragePlugin</span><span class="p">)</span> <span class="k">for</span> <span class="n">auto_plugin_type</span> <span class="ow">in</span> <span class="n">auto_plugins</span>
            <span class="p">),</span>
            <span class="s2">&quot;auto_plugins&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">auto_plugins</span> <span class="o">=</span> <span class="n">auto_plugins</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_builtin</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">bool_param</span><span class="p">(</span><span class="n">is_builtin</span><span class="p">,</span> <span class="s2">&quot;is_builtin&quot;</span><span class="p">)</span>
        <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;All types must have a valid display name, got None for key </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">inst_param</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="s2">&quot;kind&quot;</span><span class="p">,</span> <span class="n">DagsterTypeKind</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_check_fn</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">retval</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">TypeCheck</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">DagsterInvariantViolationError</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="s2">&quot;You have returned </span><span class="si">{retval}</span><span class="s2"> of type </span><span class="si">{retval_type}</span><span class="s2"> from the type &quot;</span>
                    <span class="s1">&#39;check function of type &quot;</span><span class="si">{type_key}</span><span class="s1">&quot;. Return value must be instance &#39;</span>
                    <span class="s2">&quot;of TypeCheck or a bool.&quot;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">retval</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">retval</span><span class="p">),</span> <span class="n">retval_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">retval</span><span class="p">),</span> <span class="n">type_key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="n">retval</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">retval</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="k">else</span> <span class="n">retval</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DagsterType</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">key</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_builtin_enum</span><span class="p">(</span><span class="n">builtin_enum</span><span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span><span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">builtin_enum</span><span class="p">),</span> <span class="s2">&quot;must be member of BuiltinEnum&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_RUNTIME_MAP</span><span class="p">[</span><span class="n">builtin_enum</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Asserted in __init__ to be not None, overridden in many subclasses&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The unique name of this type. Can be None if the type is not unique, such as container types&quot;&quot;&quot;</span>
        <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;unique_name requested but is None for type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">display_name</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_unique_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inner_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loader_schema_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">schema_type</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loader</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">materializer_schema_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">materializer</span><span class="o">.</span><span class="n">schema_type</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">materializer</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type_param_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_nothing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">NOTHING</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">supports_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">get_inner_type_for_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span>
            <span class="s2">&quot;DagsterType </span><span class="si">{name}</span><span class="s2"> does not support fan-in, should have checked supports_fan_in before calling getter.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">display_name</span>
            <span class="p">)</span>
        <span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_validate_type_check_fn</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">dagster.seven</span> <span class="kn">import</span> <span class="n">get_args</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

    <span class="c1"># py2 doesn&#39;t filter out self</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">possible_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;_&quot;</span><span class="p">,</span>
            <span class="s2">&quot;context&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_context&quot;</span><span class="p">,</span>
            <span class="s2">&quot;context_&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">possible_names</span><span class="p">:</span>
            <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
                <span class="s1">&#39;type_check function on type &quot;</span><span class="si">{name}</span><span class="s1">&quot; must have first &#39;</span>
                <span class="s1">&#39;argument named &quot;context&quot; (or _, _context, context_).&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,)</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
        <span class="s1">&#39;type_check_fn argument on type &quot;</span><span class="si">{name}</span><span class="s1">&quot; must take 2 arguments, &#39;</span>
        <span class="s2">&quot;received </span><span class="si">{count}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
    <span class="p">)</span>


<span class="k">class</span> <span class="nc">BuiltinScalarDagsterType</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">type_check_fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BuiltinScalarDagsterType</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">SCALAR</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="n">type_check_fn</span><span class="p">,</span>
            <span class="n">is_builtin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_check_scalar_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">type_check_scalar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_Int</span><span class="p">(</span><span class="n">BuiltinScalarDagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Int</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Int&quot;</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">INT_INPUT</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">INT_OUTPUT</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_fn</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_scalar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_typemismatch_error_str</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">expected_type_desc</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;Value &quot;</span><span class="si">{value}</span><span class="s1">&quot; of python type &quot;</span><span class="si">{python_type}</span><span class="s1">&quot; must be a </span><span class="si">{type_desc}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">python_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">type_desc</span><span class="o">=</span><span class="n">expected_type_desc</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value_type</span><span class="p">,</span> <span class="n">value_type_desc</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">_typemismatch_error_str</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value_type_desc</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_String</span><span class="p">(</span><span class="n">BuiltinScalarDagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_String</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;String&quot;</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">STRING_INPUT</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">STRING_OUTPUT</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_fn</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_scalar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_Float</span><span class="p">(</span><span class="n">BuiltinScalarDagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Float</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Float&quot;</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">FLOAT_INPUT</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">FLOAT_OUTPUT</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_fn</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_scalar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_Bool</span><span class="p">(</span><span class="n">BuiltinScalarDagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Bool</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bool&quot;</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">BOOL_INPUT</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">BOOL_OUTPUT</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_fn</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_scalar_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Anyish</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">materializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">serialization_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">is_builtin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">auto_plugins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Anyish</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">ANY</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">loader</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">materializer</span><span class="p">,</span>
            <span class="n">serialization_strategy</span><span class="o">=</span><span class="n">serialization_strategy</span><span class="p">,</span>
            <span class="n">is_builtin</span><span class="o">=</span><span class="n">is_builtin</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_method</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">auto_plugins</span><span class="o">=</span><span class="n">auto_plugins</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_context</span><span class="p">,</span> <span class="n">_value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">supports_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_inner_type_for_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Anyish all the way down</span>
        <span class="k">return</span> <span class="bp">self</span>


<span class="k">class</span> <span class="nc">_Any</span><span class="p">(</span><span class="n">Anyish</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Any</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;Any&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Any&quot;</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">ANY_INPUT</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">ANY_OUTPUT</span><span class="p">,</span>
            <span class="n">is_builtin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">create_any_type</span><span class="p">(</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="n">loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">materializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">serialization_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">auto_plugins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Anyish</span><span class="p">(</span>
        <span class="n">key</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="n">loader</span><span class="o">=</span><span class="n">loader</span><span class="p">,</span>
        <span class="n">materializer</span><span class="o">=</span><span class="n">materializer</span><span class="p">,</span>
        <span class="n">serialization_strategy</span><span class="o">=</span><span class="n">serialization_strategy</span><span class="p">,</span>
        <span class="n">auto_plugins</span><span class="o">=</span><span class="n">auto_plugins</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">class</span> <span class="nc">_Nothing</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">_Nothing</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="s2">&quot;Nothing&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Nothing&quot;</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">NOTHING</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_method</span><span class="p">,</span>
            <span class="n">is_builtin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Value must be None, got a </span><span class="si">{value_type}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">supports_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_inner_type_for_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>


<div class="viewcode-block" id="PythonObjectDagsterType"><a class="viewcode-back" href="../../../../sections/api/apidocs/types.html#dagster_pandas.PythonObjectDagsterType">[docs]</a><span class="k">class</span> <span class="nc">PythonObjectDagsterType</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Define a type in dagster whose typecheck is an isinstance check.</span>

<span class="sd">    Specifically, the type can either be a single python type (e.g. int),</span>
<span class="sd">    or a tuple of types (e.g. (int, float)) which is treated as a union.</span>

<span class="sd">    Examples:</span>
<span class="sd">        .. code-block:: python</span>

<span class="sd">            ntype = PythonObjectDagsterType(python_type=int)</span>
<span class="sd">            assert ntype.name == &#39;int&#39;</span>
<span class="sd">            assert_success(ntype, 1)</span>
<span class="sd">            assert_failure(ntype, &#39;a&#39;)</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            ntype = PythonObjectDagsterType(python_type=(int, float))</span>
<span class="sd">            assert ntype.name == &#39;Union[int, float]&#39;</span>
<span class="sd">            assert_success(ntype, 1)</span>
<span class="sd">            assert_success(ntype, 1.5)</span>
<span class="sd">            assert_failure(ntype, &#39;a&#39;)</span>


<span class="sd">    Args:</span>
<span class="sd">        python_type (Union[Type, Tuple[Type, ...]): The dagster typecheck function calls instanceof on</span>
<span class="sd">            this type.</span>
<span class="sd">        name (Optional[str]): Name the type. Defaults to the name of ``python_type``.</span>
<span class="sd">        key (Optional[str]): Key of the type. Defaults to name.</span>
<span class="sd">        description (Optional[str]): A markdown-formatted string, displayed in tooling.</span>
<span class="sd">        loader (Optional[DagsterTypeLoader]): An instance of a class that</span>
<span class="sd">            inherits from :py:class:`~dagster.DagsterTypeLoader` and can map config data to a value of</span>
<span class="sd">            this type. Specify this argument if you will need to shim values of this type using the</span>
<span class="sd">            config machinery. As a rule, you should use the</span>
<span class="sd">            :py:func:`@dagster_type_loader &lt;dagster.dagster_type_loader&gt;` decorator to construct</span>
<span class="sd">            these arguments.</span>
<span class="sd">        materializer (Optional[DagsterTypeMaterializer]): An instance of a class</span>
<span class="sd">            that inherits from :py:class:`~dagster.DagsterTypeMaterializer` and can persist values of</span>
<span class="sd">            this type. As a rule, you should use the</span>
<span class="sd">            :py:func:`@dagster_type_mate &lt;dagster.dagster_type_mate&gt;`</span>
<span class="sd">            decorator to construct these arguments.</span>
<span class="sd">        serialization_strategy (Optional[SerializationStrategy]): An instance of a class that</span>
<span class="sd">            inherits from :py:class:`SerializationStrategy`. The default strategy for serializing</span>
<span class="sd">            this value when automatically persisting it between execution steps. You should set</span>
<span class="sd">            this value if the ordinary serialization machinery (e.g., pickle) will not be adequate</span>
<span class="sd">            for this type.</span>
<span class="sd">        auto_plugins (Optional[List[Type[TypeStoragePlugin]]]): If types must be serialized differently</span>
<span class="sd">            depending on the storage being used for intermediates, they should specify this</span>
<span class="sd">            argument. In these cases the serialization_strategy argument is not sufficient because</span>
<span class="sd">            serialization requires specialized API calls, e.g. to call an S3 API directly instead</span>
<span class="sd">            of using a generic file object. See ``dagster_pyspark.DataFrame`` for an example.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">python_type</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">python_type</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">python_type</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">tuple_param</span><span class="p">(</span>
                <span class="n">python_type</span><span class="p">,</span> <span class="s2">&quot;python_type&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">type</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">python_type</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_str</span> <span class="o">=</span> <span class="s2">&quot;Union[</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">python_type</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">python_type</span> <span class="ow">in</span> <span class="n">python_type</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">python_type</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">type_param</span><span class="p">(</span><span class="n">python_type</span><span class="p">,</span> <span class="s2">&quot;python_type&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_str</span> <span class="o">=</span> <span class="n">python_type</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_str</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PythonObjectDagsterType</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">python_type</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span>
                <span class="n">success</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;Value of type </span><span class="si">{value_type}</span><span class="s2"> failed type check for Dagster type </span><span class="si">{dagster_type}</span><span class="s2">, &quot;</span>
                    <span class="s2">&quot;expected value to be of Python type </span><span class="si">{expected_type}</span><span class="s2">.&quot;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">value_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">dagster_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="n">expected_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_str</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">NoneableInputSchema</span><span class="p">(</span><span class="n">DagsterTypeLoader</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_dagster_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inner_dagster_type</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">inst_param</span><span class="p">(</span>
            <span class="n">inner_dagster_type</span><span class="p">,</span> <span class="s2">&quot;inner_dagster_type&quot;</span><span class="p">,</span> <span class="n">DagsterType</span>
        <span class="p">)</span>
        <span class="n">check</span><span class="o">.</span><span class="n">param_invariant</span><span class="p">(</span><span class="n">inner_dagster_type</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;inner_dagster_type&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type</span> <span class="o">=</span> <span class="n">ConfigNoneable</span><span class="p">(</span><span class="n">inner_dagster_type</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">schema_type</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">schema_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type</span>

    <span class="k">def</span> <span class="nf">construct_from_config_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">config_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">config_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inner_dagster_type</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">construct_from_config_value</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">config_value</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_create_nullable_input_schema</span><span class="p">(</span><span class="n">inner_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inner_type</span><span class="o">.</span><span class="n">loader</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">NoneableInputSchema</span><span class="p">(</span><span class="n">inner_type</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">OptionalType</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">):</span>
        <span class="n">inner_type</span> <span class="o">=</span> <span class="n">resolve_dagster_type</span><span class="p">(</span><span class="n">inner_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inner_type</span> <span class="ow">is</span> <span class="n">Nothing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
                <span class="s2">&quot;Type Nothing can not be wrapped in List or Optional&quot;</span>
            <span class="p">)</span>

        <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;Optional.&quot;</span> <span class="o">+</span> <span class="n">inner_type</span><span class="o">.</span><span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span> <span class="o">=</span> <span class="n">inner_type</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">OptionalType</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">NULLABLE</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_method</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">_create_nullable_input_schema</span><span class="p">(</span><span class="n">inner_type</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">display_name</span> <span class="o">+</span> <span class="s2">&quot;?&quot;</span>

    <span class="k">def</span> <span class="nf">type_check_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">type_check</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inner_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">inner_types</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type_param_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">supports_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">supports_fan_in</span>

    <span class="k">def</span> <span class="nf">get_inner_type_for_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">get_inner_type_for_fan_in</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">ListInputSchema</span><span class="p">(</span><span class="n">DagsterTypeLoader</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_dagster_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inner_dagster_type</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">inst_param</span><span class="p">(</span>
            <span class="n">inner_dagster_type</span><span class="p">,</span> <span class="s2">&quot;inner_dagster_type&quot;</span><span class="p">,</span> <span class="n">DagsterType</span>
        <span class="p">)</span>
        <span class="n">check</span><span class="o">.</span><span class="n">param_invariant</span><span class="p">(</span><span class="n">inner_dagster_type</span><span class="o">.</span><span class="n">loader</span><span class="p">,</span> <span class="s2">&quot;inner_dagster_type&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">inner_dagster_type</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">schema_type</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">schema_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type</span>

    <span class="k">def</span> <span class="nf">construct_from_config_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">config_value</span><span class="p">):</span>
        <span class="n">convert_item</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_inner_dagster_type</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">construct_from_config_value</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">convert_item</span><span class="p">,</span> <span class="n">config_value</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_create_list_input_schema</span><span class="p">(</span><span class="n">inner_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inner_type</span><span class="o">.</span><span class="n">loader</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">ListInputSchema</span><span class="p">(</span><span class="n">inner_type</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ListType</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;List.&quot;</span> <span class="o">+</span> <span class="n">inner_type</span><span class="o">.</span><span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span> <span class="o">=</span> <span class="n">inner_type</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ListType</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">LIST</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_method</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">_create_list_input_schema</span><span class="p">(</span><span class="n">inner_type</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">display_name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>

    <span class="k">def</span> <span class="nf">type_check_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">value_check</span> <span class="o">=</span> <span class="n">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value_check</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value_check</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">item_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">type_check</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">item_check</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item_check</span>

        <span class="k">return</span> <span class="n">TypeCheck</span><span class="p">(</span><span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inner_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">inner_types</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type_param_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span><span class="o">.</span><span class="n">key</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">supports_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">get_inner_type_for_fan_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_type</span>


<span class="k">class</span> <span class="nc">DagsterListApi</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">not_none_param</span><span class="p">(</span><span class="n">inner_type</span><span class="p">,</span> <span class="s2">&quot;inner_type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_List</span><span class="p">(</span><span class="n">resolve_dagster_type</span><span class="p">(</span><span class="n">inner_type</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">not_none_param</span><span class="p">(</span><span class="n">inner_type</span><span class="p">,</span> <span class="s2">&quot;inner_type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_List</span><span class="p">(</span><span class="n">inner_type</span><span class="p">)</span>


<span class="n">List</span> <span class="o">=</span> <span class="n">DagsterListApi</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_List</span><span class="p">(</span><span class="n">inner_type</span><span class="p">):</span>
    <span class="n">check</span><span class="o">.</span><span class="n">inst_param</span><span class="p">(</span><span class="n">inner_type</span><span class="p">,</span> <span class="s2">&quot;inner_type&quot;</span><span class="p">,</span> <span class="n">DagsterType</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">inner_type</span> <span class="ow">is</span> <span class="n">Nothing</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span><span class="s2">&quot;Type Nothing can not be wrapped in List or Optional&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ListType</span><span class="p">(</span><span class="n">inner_type</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Stringish</span><span class="p">(</span><span class="n">DagsterType</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">check</span><span class="o">.</span><span class="n">opt_str_param</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Stringish</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">DagsterTypeKind</span><span class="o">.</span><span class="n">SCALAR</span><span class="p">,</span>
            <span class="n">type_check_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_check_method</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">STRING_INPUT</span><span class="p">,</span>
            <span class="n">materializer</span><span class="o">=</span><span class="n">BuiltinSchemas</span><span class="o">.</span><span class="n">STRING_OUTPUT</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">type_check_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_context</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_fail_if_not_of_type</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_string_type</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Stringish</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span>


<span class="n">Any</span> <span class="o">=</span> <span class="n">_Any</span><span class="p">()</span>
<span class="n">Bool</span> <span class="o">=</span> <span class="n">_Bool</span><span class="p">()</span>
<span class="n">Float</span> <span class="o">=</span> <span class="n">_Float</span><span class="p">()</span>
<span class="n">Int</span> <span class="o">=</span> <span class="n">_Int</span><span class="p">()</span>
<span class="n">String</span> <span class="o">=</span> <span class="n">_String</span><span class="p">()</span>
<span class="n">Nothing</span> <span class="o">=</span> <span class="n">_Nothing</span><span class="p">()</span>

<span class="n">_RUNTIME_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">ANY</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">BOOL</span><span class="p">:</span> <span class="n">Bool</span><span class="p">,</span>
    <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">:</span> <span class="n">Float</span><span class="p">,</span>
    <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">INT</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
    <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">STRING</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span>
    <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">NOTHING</span><span class="p">:</span> <span class="n">Nothing</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">_PYTHON_TYPE_TO_DAGSTER_TYPE_MAPPING_REGISTRY</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="n">DagsterType</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="sd">&quot;&quot;&quot;Python types corresponding to user-defined RunTime types created using @map_to_dagster_type or</span>
<span class="sd">as_dagster_type are registered here so that we can remap the Python types to runtime types.&quot;&quot;&quot;</span>


<div class="viewcode-block" id="make_python_type_usable_as_dagster_type"><a class="viewcode-back" href="../../../../sections/api/apidocs/types.html#dagster_pandas.make_python_type_usable_as_dagster_type">[docs]</a><span class="k">def</span> <span class="nf">make_python_type_usable_as_dagster_type</span><span class="p">(</span><span class="n">python_type</span><span class="p">,</span> <span class="n">dagster_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take any existing python type and map it to a dagster type (generally created with</span>
<span class="sd">    :py:class:`DagsterType &lt;dagster.DagsterType&gt;`) This can only be called once</span>
<span class="sd">    on a given python type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">check</span><span class="o">.</span><span class="n">inst_param</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="s2">&quot;dagster_type&quot;</span><span class="p">,</span> <span class="n">DagsterType</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">_PYTHON_TYPE_TO_DAGSTER_TYPE_MAPPING_REGISTRY</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">python_type</span><span class="p">,</span> <span class="n">dagster_type</span><span class="p">)</span>
        <span class="ow">is</span> <span class="ow">not</span> <span class="n">dagster_type</span>
    <span class="p">):</span>
        <span class="c1"># This would be just a great place to insert a short URL pointing to the type system</span>
        <span class="c1"># documentation into the error message</span>
        <span class="c1"># https://github.com/dagster-io/dagster/issues/1831</span>
        <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;A Dagster type has already been registered for the Python type &quot;</span>
                <span class="s2">&quot;</span><span class="si">{python_type}</span><span class="s2">. make_python_type_usable_as_dagster_type can only &quot;</span>
                <span class="s2">&quot;be called once on a python type as it is registering a 1:1 mapping &quot;</span>
                <span class="s2">&quot;between that python type and a dagster type.&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">python_type</span><span class="o">=</span><span class="n">python_type</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">_PYTHON_TYPE_TO_DAGSTER_TYPE_MAPPING_REGISTRY</span><span class="p">[</span><span class="n">python_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">dagster_type</span></div>


<span class="n">DAGSTER_INVALID_TYPE_ERROR_MESSAGE</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;Invalid type: dagster_type must be DagsterType, a python scalar, or a python type &quot;</span>
    <span class="s2">&quot;that has been marked usable as a dagster type via @usable_dagster_type or &quot;</span>
    <span class="s2">&quot;make_python_type_usable_as_dagster_type: got </span><span class="si">{dagster_type}{additional_msg}</span><span class="s2">&quot;</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">resolve_dagster_type</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">):</span>
    <span class="c1"># circular dep</span>
    <span class="kn">from</span> <span class="nn">.python_dict</span> <span class="kn">import</span> <span class="n">PythonDict</span><span class="p">,</span> <span class="n">Dict</span>
    <span class="kn">from</span> <span class="nn">.python_set</span> <span class="kn">import</span> <span class="n">PythonSet</span><span class="p">,</span> <span class="n">DagsterSetApi</span>
    <span class="kn">from</span> <span class="nn">.python_tuple</span> <span class="kn">import</span> <span class="n">PythonTuple</span><span class="p">,</span> <span class="n">DagsterTupleApi</span>
    <span class="kn">from</span> <span class="nn">.transform_typing</span> <span class="kn">import</span> <span class="n">transform_typing_type</span>
    <span class="kn">from</span> <span class="nn">dagster.config.config_type</span> <span class="kn">import</span> <span class="n">ConfigType</span>
    <span class="kn">from</span> <span class="nn">dagster.primitive_mapping</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">remap_python_builtin_for_runtime</span><span class="p">,</span>
        <span class="n">is_supported_runtime_python_builtin</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="kn">from</span> <span class="nn">dagster.utils.typing_api</span> <span class="kn">import</span> <span class="n">is_typing_type</span>

    <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span>
        <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="n">ConfigType</span><span class="p">)),</span>
        <span class="s2">&quot;Cannot resolve a config type to a runtime type&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">check</span><span class="o">.</span><span class="n">invariant</span><span class="p">(</span>
        <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="n">DagsterType</span><span class="p">)),</span>
        <span class="s2">&quot;Do not pass runtime type classes. Got </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># First check to see if it part of python&#39;s typing library</span>
    <span class="k">if</span> <span class="n">is_typing_type</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">):</span>
        <span class="n">dagster_type</span> <span class="o">=</span> <span class="n">transform_typing_type</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="n">DagsterType</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dagster_type</span>

    <span class="c1"># Test for unhashable objects -- this is if, for instance, someone has passed us an instance of</span>
    <span class="c1"># a dict where they meant to pass dict or Dict, etc.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">hash</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
            <span class="n">DAGSTER_INVALID_TYPE_ERROR_MESSAGE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">additional_msg</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;, which isn&#39;t hashable. Did you pass an instance of a type instead of &quot;</span>
                    <span class="s2">&quot;the type?&quot;</span>
                <span class="p">),</span>
                <span class="n">dagster_type</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">is_supported_runtime_python_builtin</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">remap_python_builtin_for_runtime</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dagster_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Any</span>

    <span class="k">if</span> <span class="n">dagster_type</span> <span class="ow">in</span> <span class="n">_PYTHON_TYPE_TO_DAGSTER_TYPE_MAPPING_REGISTRY</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_PYTHON_TYPE_TO_DAGSTER_TYPE_MAPPING_REGISTRY</span><span class="p">[</span><span class="n">dagster_type</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">dagster_type</span> <span class="ow">is</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PythonDict</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="n">DagsterTupleApi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PythonTuple</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="n">DagsterSetApi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PythonSet</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="n">DagsterListApi</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">List</span><span class="p">(</span><span class="n">Any</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">BuiltinEnum</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DagsterType</span><span class="o">.</span><span class="n">from_builtin_enum</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
            <span class="n">DAGSTER_INVALID_TYPE_ERROR_MESSAGE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">dagster_type</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">dagster_type</span><span class="p">),</span> <span class="n">additional_msg</span><span class="o">=</span><span class="s2">&quot;.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">{dagster_type}</span><span class="s2"> is not a valid dagster type.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dagster_type</span><span class="o">=</span><span class="n">dagster_type</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">ALL_RUNTIME_BUILTINS</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_RUNTIME_MAP</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">construct_dagster_type_dictionary</span><span class="p">(</span><span class="n">solid_defs</span><span class="p">):</span>
    <span class="n">type_dict_by_name</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span><span class="o">.</span><span class="n">unique_name</span><span class="p">:</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ALL_RUNTIME_BUILTINS</span><span class="p">}</span>
    <span class="n">type_dict_by_key</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span><span class="o">.</span><span class="n">key</span><span class="p">:</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ALL_RUNTIME_BUILTINS</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">solid_def</span> <span class="ow">in</span> <span class="n">solid_defs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dagster_type</span> <span class="ow">in</span> <span class="n">solid_def</span><span class="o">.</span><span class="n">all_dagster_types</span><span class="p">():</span>
            <span class="c1"># We don&#39;t do uniqueness check on key because with classes</span>
            <span class="c1"># like Array, Noneable, etc, those are ephemeral objects</span>
            <span class="c1"># and it is perfectly fine to have many of them.</span>
            <span class="n">type_dict_by_key</span><span class="p">[</span><span class="n">dagster_type</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">dagster_type</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">dagster_type</span><span class="o">.</span><span class="n">has_unique_name</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">dagster_type</span><span class="o">.</span><span class="n">unique_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">type_dict_by_name</span><span class="p">:</span>
                <span class="n">type_dict_by_name</span><span class="p">[</span><span class="n">dagster_type</span><span class="o">.</span><span class="n">unique_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dagster_type</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">type_dict_by_name</span><span class="p">[</span><span class="n">dagster_type</span><span class="o">.</span><span class="n">unique_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">dagster_type</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DagsterInvalidDefinitionError</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="s1">&#39;You have created two dagster types with the same name &quot;</span><span class="si">{type_name}</span><span class="s1">&quot;. &#39;</span>
                        <span class="s2">&quot;Dagster types have must have unique names.&quot;</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">type_name</span><span class="o">=</span><span class="n">dagster_type</span><span class="o">.</span><span class="n">display_name</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">type_dict_by_key</span>


<span class="k">class</span> <span class="nc">DagsterOptionalApi</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_type</span><span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">not_none_param</span><span class="p">(</span><span class="n">inner_type</span><span class="p">,</span> <span class="s2">&quot;inner_type&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">OptionalType</span><span class="p">(</span><span class="n">inner_type</span><span class="p">)</span>


<span class="n">Optional</span> <span class="o">=</span> <span class="n">DagsterOptionalApi</span><span class="p">()</span>
</pre></div>

            </div>
            <div class="related bottom">
                &nbsp;
<nav id="rellinks">
    <ul>
        <li>
            <a href="/" title="Home">Home</a>
        </li>
    </ul>
</nav>
            </div>
            
        </div>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3><a href="../../../../index.html">Dagster</a></h3>

<div id="searchbox" style="display: none" role="search">
  <h2 id="searchlabel">Search</h2>
  <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
  </div>
</div>
<script type="text/javascript">
  $("#searchbox").show(0);
</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


  </body>
</html>